
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for the jp-mining-note project.">
      
      
      
        <link rel="canonical" href="https://arbyste.github.io/jp-mining-note-prerelease/scripts/">
      
      
        <link rel="prev" href="../jpmnhandlebars/">
      
      
        <link rel="next" href="../jpresourcesother/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.15">
    
    
      
        <title>Anki Hotkeys (TODO) - jp-mining-note</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sharex-hotkeys" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
            

<b class="jpmn-highlight">WARNING</b>: This documentation is for the latest pre-release version of jp-mining-note, and is very WIP / incomplete. <br>
If you are looking for the stable release documentation, see <a href="https://arbyste.github.io/jp-mining-note/">here</a>.


          </div>
          
        </aside>
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="jp-mining-note" class="md-header__button md-logo" aria-label="jp-mining-note" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            jp-mining-note
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Anki Hotkeys (TODO)
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/arbyste/jp-mining-note/tree/dev" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    jp-mining-note
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        Home
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../setup/" class="md-tabs__link">
        Setup
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../updating/" class="md-tabs__link">
        Updating
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../quickstart/" class="md-tabs__link">
        Reference
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../modding/" class="md-tabs__link">
        Dev Docs
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../faq/" class="md-tabs__link">
        FAQ & Troubleshooting
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../jpresources/" class="md-tabs__link md-tabs__link--active">
        JP Resources
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="jp-mining-note" class="md-nav__button md-logo" aria-label="jp-mining-note" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    jp-mining-note
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/arbyste/jp-mining-note/tree/dev" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    jp-mining-note
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
      
      
      
        <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
          Home
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Home
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_2" >
      
      
      
        <label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="0">
          Getting Started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1_2">
          <span class="md-nav__icon md-icon"></span>
          Getting Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../preface/" class="md-nav__link">
        Preface
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../principles/" class="md-nav__link">
        Philosophy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../alternatives/" class="md-nav__link">
        Alternatives
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Setup
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Setup
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setup/" class="md-nav__link">
        Setup: Installing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setupanki/" class="md-nav__link">
        Setup: Anki
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setupyomichan/" class="md-nav__link">
        Setup: Yomichan
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setuptextmedia/" class="md-nav__link">
        Setup: Text & Media
      </a>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
      
      
      
        <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
          Text & Media
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_5">
          <span class="md-nav__icon md-icon"></span>
          Text & Media
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setupmpvacious/" class="md-nav__link">
        mpvacious
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setupasbplayer/" class="md-nav__link">
        asbplayer
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
      
      
      
        <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
          Transfer Existing Notes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_6">
          <span class="md-nav__icon md-icon"></span>
          Transfer Existing Notes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../importing/" class="md-nav__link">
        Transfer Existing Notes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_7" >
      
      
      
        <label class="md-nav__link" for="__nav_2_7" id="__nav_2_7_label" tabindex="0">
          Extra Setup
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_7">
          <span class="md-nav__icon md-icon"></span>
          Extra Setup
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setupextrayomichan/" class="md-nav__link">
        Extra: Yomichan
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setupextraanki/" class="md-nav__link">
        Extra: Anki
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setupandroid/" class="md-nav__link">
        Extra: Android
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setupios/" class="md-nav__link">
        Extra: iOS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setupereaders/" class="md-nav__link">
        Extra: eReaders
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_8" >
      
      
      
        <label class="md-nav__link" for="__nav_2_8" id="__nav_2_8_label" tabindex="0">
          Alternate Card Exporters
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_8">
          <span class="md-nav__icon md-icon"></span>
          Alternate Card Exporters
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setupjl/" class="md-nav__link">
        JL (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setupjidoujisho/" class="md-nav__link">
        jidoujisho (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setupgoldendict/" class="md-nav__link">
        goldendict (TODO)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Updating
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Updating
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../updating/" class="md-nav__link">
        Updating: Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../updatingjpmn/" class="md-nav__link">
        Updating: JPMN
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../updatingyomichan/" class="md-nav__link">
        Updating: Yomichan
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../setupchanges/" class="md-nav__link">
        Setup Changes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../updatingfinalsteps/" class="md-nav__link">
        Final Steps
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/arbyste/jp-mining-note/blob/dev/CHANGELOG.md" class="md-nav__link">
        Changelog
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../updatingaquafinaversion/" class="md-nav__link">
        Updating from Aquafina's Version
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart/" class="md-nav__link">
        Quick Start (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../blockquotes/" class="md-nav__link">
        Blockquotes (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../definitions/" class="md-nav__link">
        Definitions (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sentences/" class="md-nav__link">
        Sentences (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cardtypes/" class="md-nav__link">
        Card Types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../changingcardtype/" class="md-nav__link">
        Changing Card Type (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cardtypes2/" class="md-nav__link">
        More on Card Types (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../keybinds/" class="md-nav__link">
        Keybinds
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../images/" class="md-nav__link">
        Images
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../autopa/" class="md-nav__link">
        Pitch Accent
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kanjihover/" class="md-nav__link">
        Kanji Hover (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../wordindicators/" class="md-nav__link">
        Word Indicators (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tooltipresults/" class="md-nav__link">
        Tooltip Results (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../infocircle/" class="md-nav__link">
        Info Circle (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../frequencies/" class="md-nav__link">
        Frequencies (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../externallinks/" class="md-nav__link">
        External Links (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../fields/" class="md-nav__link">
        Fields (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../backfilling/" class="md-nav__link">
        Backfilling (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../batch/" class="md-nav__link">
        Batch Commands (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../other/" class="md-nav__link">
        Other (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_21" >
      
      
      
        <label class="md-nav__link" for="__nav_4_21" id="__nav_4_21_label" tabindex="0">
          Options
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_21_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4_21">
          <span class="md-nav__icon md-icon"></span>
          Options
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../runtimeoptions/" class="md-nav__link">
        Runtime Options (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../compiletimeoptions/" class="md-nav__link">
        Compile Options (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../yomichantemplates/" class="md-nav__link">
        Yomichan Template Options (TODO)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
      
        <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
          Dev Docs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Dev Docs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modding/" class="md-nav__link">
        Modding Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../building/" class="md-nav__link">
        Building
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../customcss/" class="md-nav__link">
        Custom CSS (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../overrides/" class="md-nav__link">
        Custom HTML (Overrides) (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../modules/" class="md-nav__link">
        Custom JS (Modules) (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../themes/" class="md-nav__link">
        Themes (TODO)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../moddingtips/" class="md-nav__link">
        Tips & Tricks (TODO)
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          FAQ & Troubleshooting
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          FAQ & Troubleshooting
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        FAQ & Troubleshooting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/#errors-warnings" class="md-nav__link">
        FAQ: Errors & Warnings
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/#troubleshooting" class="md-nav__link">
        FAQ: Troubleshooting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/#card-editing" class="md-nav__link">
        FAQ: Card Editing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../faq/#other-questions" class="md-nav__link">
        FAQ: Other
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          JP Resources
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          JP Resources
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../jpresources/" class="md-nav__link">
        JP Resources
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../jpmnhandlebars/" class="md-nav__link">
        JPMN Handlebars Package
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Anki Hotkeys (TODO)
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Anki Hotkeys (TODO)
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sharex-hotkeys" class="md-nav__link">
    ShareX Hotkeys
  </a>
  
    <nav class="md-nav" aria-label="ShareX Hotkeys">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#feature-summary" class="md-nav__link">
    Feature Summary
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sharex-hotkeys-prerequisites" class="md-nav__link">
    ShareX Hotkeys Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sharex-screenshot-hotkey" class="md-nav__link">
    ShareX Screenshot Hotkey
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sharex-screenshot-hotkey-nsfw" class="md-nav__link">
    ShareX Screenshot Hotkey (NSFW)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sharex-audio-hotkey" class="md-nav__link">
    ShareX Audio Hotkey
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    Troubleshooting
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#other-hotkeys" class="md-nav__link">
    Other Hotkeys
  </a>
  
    <nav class="md-nav" aria-label="Other Hotkeys">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-to-running-with-sharex" class="md-nav__link">
    How-To: Running with ShareX
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-running-with-command-line" class="md-nav__link">
    How-To: Running with Command Line
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-running-with-autokey" class="md-nav__link">
    How-To: Running with AutoKey
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-sentence-with-clipboard" class="md-nav__link">
    Update Sentence with Clipboard
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-additionalnotes-with-clipboard" class="md-nav__link">
    Update AdditionalNotes with Clipboard
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy-from-previous-card" class="md-nav__link">
    Copy from Previous Card
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#orthographic-variants-fix-sentence-and-frequency" class="md-nav__link">
    Orthographic Variants: Fix Sentence and Frequency
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deprecated-scripts" class="md-nav__link">
    Deprecated Scripts
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../jpresourcesother/" class="md-nav__link">
        Other
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#sharex-hotkeys" class="md-nav__link">
    ShareX Hotkeys
  </a>
  
    <nav class="md-nav" aria-label="ShareX Hotkeys">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#feature-summary" class="md-nav__link">
    Feature Summary
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sharex-hotkeys-prerequisites" class="md-nav__link">
    ShareX Hotkeys Prerequisites
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sharex-screenshot-hotkey" class="md-nav__link">
    ShareX Screenshot Hotkey
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sharex-screenshot-hotkey-nsfw" class="md-nav__link">
    ShareX Screenshot Hotkey (NSFW)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sharex-audio-hotkey" class="md-nav__link">
    ShareX Audio Hotkey
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#troubleshooting" class="md-nav__link">
    Troubleshooting
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#other-hotkeys" class="md-nav__link">
    Other Hotkeys
  </a>
  
    <nav class="md-nav" aria-label="Other Hotkeys">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-to-running-with-sharex" class="md-nav__link">
    How-To: Running with ShareX
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-running-with-command-line" class="md-nav__link">
    How-To: Running with Command Line
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-to-running-with-autokey" class="md-nav__link">
    How-To: Running with AutoKey
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-sentence-with-clipboard" class="md-nav__link">
    Update Sentence with Clipboard
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#update-additionalnotes-with-clipboard" class="md-nav__link">
    Update AdditionalNotes with Clipboard
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#copy-from-previous-card" class="md-nav__link">
    Copy from Previous Card
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#orthographic-variants-fix-sentence-and-frequency" class="md-nav__link">
    Orthographic Variants: Fix Sentence and Frequency
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deprecated-scripts" class="md-nav__link">
    Deprecated Scripts
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  
    
      
    
    <a href="https://github.com/arbyste/jp-mining-note/tree/dev/raw/dev/docs/docs/scripts.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.15 8.15 0 0 1-1.23-2Z"/></svg>
    </a>
  


  <h1>Anki Hotkeys (TODO)</h1>

<div><p>This page serves as a collection of small Anki-related scripts primarily for the usage
automating repetitive tasks with hotkeys.</p>
<p>It is separated into two main sections:</p>
<ul>
<li>ShareX Hotkeys: Hotkeys meant to be specifically used with media files generated from <a href="https://getsharex.com/">ShareX</a>.</li>
<li>Anki Hotkeys: General purpose hotkeys that act on the most recent card(s). Does not require media files to operate.</li>
</ul>
<p>TODO demo</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The ShareX hotkeys are originally based off of
<a href="https://github.com/Aquafina-water-bottle/stegatxins0-mining/">Stegatxins0's Mining Setup</a>.
That was itself originally based off of
<a href="https://animecards.site/media/#setting-up-sharex">AnimeCard's ShareX Setup</a>.</p>
</div>
<hr>
<h2 id="sharex-hotkeys">ShareX Hotkeys<a class="headerlink" href="#sharex-hotkeys" title="Permanent link">¶</a></h2>
<p>Windows users can use <a href="https://getsharex.com/">ShareX</a> as a general purpose tool
to automatically add images and audio to your most recently created card.
There are two main hotkeys that this setup introduces:</p>
<ul>
<li>A screenshot hotkey</li>
<li>An audio hotkey</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are using Linux, I recommend using <a href="https://github.com/eshrh/ames">ames</a> instead of ShareX.
Unfortunately, I'm not aware of a good solution for macOS users.</p>
</div>
<h3 id="feature-summary">Feature Summary<a class="headerlink" href="#feature-summary" title="Permanent link">¶</a></h3>
<ul>
<li>Audio is automatically normalized, and attempts to remove silence at the beginning of the audio.</li>
<li>Images are saved as webp, to save disk space.</li>
<li>The screenshot hotkey automatically adds the Window name as a tag to the card.</li>
<li>Work with any note type, given that the correct flags are provided.
    By default, these work with jp-mining-note and AnimeCards.</li>
<li>Instead of using PowerShell, this setup uses Python. Unfortunately, this is a little bit more
    difficult to setup for the average user, but using Python makes it much easier to
    develop and maintain the underlying scripts. Most people, including myself,
    know Python much more than PowerShell.
    Additionally, Python is generally cross platform and easy enough to setup on all operating systems.</li>
</ul>
<h3 id="sharex-hotkeys-prerequisites">ShareX Hotkeys Prerequisites<a class="headerlink" href="#sharex-hotkeys-prerequisites" title="Permanent link">¶</a></h3>
<p>To use these hotkeys with ShareX, you must have the following installed:</p>
<ul>
<li><a href="https://getsharex.com/">ShareX</a></li>
<li><a href="https://www.python.org/">Python</a> (Python 3.10 or above should work)</li>
<li><a href="https://ankiweb.net/shared/info/2055492159">Anki-Connect</a> (You probably have this installed already if you're using Yomichan or jp-mining-note).</li>
<li><code>hotkey.py</code> (see below)</li>
</ul>
<p>The <code>hotkey.py</code> file can be downloaded in any of the following ways:</p>
<details class="info">
<summary>Option 1: JPMN Manager <small>(click here)</small></summary>
<p>If you have <a href="https://ankiweb.net/shared/info/301910299">JPMN Manager</a> installed,
then this script is already available to you!
It is located under the <a href="../faq/#where-is-the-x-folder-in-anki">Anki folder</a>:
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>Anki2/addons21/301910299/tools/hotkey.py
</code></pre></div>
</details>
<details class="info">
<summary>Option 2: With <code>git</code> <small>(click here)</small></summary>
<p>For <code>git</code> users, simply clone the JPMN repository in somewhere you'll remember:
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>git clone https://github.com/arbyste/jp-mining-note.git
</code></pre></div>
The hotkey.py file will be found under <code>(repo root)/tools/hotkey.py</code>.
<!-- extra paragraph required due to mkdocs-video for some reason -->
<p></p>
</details>
<details class="info">
<summary>Option 3: Manually <small>(click here)</small></summary>
<p>If none of the above works / you don't know what <code>git</code> is:</p>
<ul>
<li>Navigate to a folder you'll remember.</li>
<li>Right click on some blank space, and then create a new text file (<code>New</code> -&gt; <code>Text Document</code>). Name this text file <code>hotkey.py</code>.</li>
<li><a href="https://raw.githubusercontent.com/arbyste/jp-mining-note/dev/tools/hotkey.py">Copy the script text</a> into the new text file, and save (<code>Ctrl+S</code>).
TODO gif!</li>
</ul>
</details>
<h3 id="sharex-screenshot-hotkey">ShareX Screenshot Hotkey<a class="headerlink" href="#sharex-screenshot-hotkey" title="Permanent link">¶</a></h3>
<ol>
<li>
<p><strong>Create the hotkey</strong>:</p>
<ul>
<li>Open ShareX, if you haven't already.</li>
<li>On the sidebar to the left, click on <code>Hotkey settings...</code>.
    (TODO image)</li>
<li>Within the Hotkey Settings window, click <code>Add</code>.
    (TODO image)</li>
<li>Set the task to be <code>Screen capture</code> -&gt; <code>Capture region</code>.</li>
<li>Set the hotkey value to whatever you want. For example, <code>F6</code>.</li>
</ul>
<p>(TODO gif)</p>
</li>
<li>
<p><strong>Change the hotkey settings</strong>:</p>
<ol>
<li>
<p>Click on the gear of your new <code>Capture Region</code> hotkey.
    (TODO image)</p>
</li>
<li>
<p>Navigate to the <code>Task</code> tab.</p>
<ul>
<li>Check <code>Override after capture settings</code> (<input type="checkbox" disabled checked>)</li>
<li>Navigate to the capture tasks dropdown, and only have the following two items selected:<ul>
<li>Save image to file</li>
<li>Perform actions
(TODO image)</li>
</ul>
</li>
<li>Check <code>Override screenshots folder</code> (<input type="checkbox" disabled checked>)</li>
<li>Click <code>Browse</code> and select your Anki collection media location.
    Your media location can be found under:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>C:\Users\YOUR_USER_NAME\AppData\Roaming\Anki2\YOUR_ANKI_PROFILE_NAME\collection.media
</code></pre></div>
    Tip: An easy way to navigate to this is by entering <code>%APPDATA%</code> in the path of the file browser.</li>
<li>To make it easier for you to remember what this hotkey does,
    set the <code>Description</code> to <code>anki-screenshot</code>.
Your <code>Task</code> tab should now look something like this:
(TODO image)</li>
</ul>
</li>
<li>
<p>Navigate to the <code>General</code> tab.</p>
<ul>
<li>Check <code>Override general settings</code> (<input type="checkbox" disabled checked>)
(TODO image)</li>
</ul>
</li>
<li>
<p>Navigate to the <code>General</code> -&gt; <code>Notifications</code> tab.</p>
<ul>
<li>Uncheck <code>Play sound after capture is made</code> (<input type="checkbox" disabled>)</li>
<li>Uncheck <code>Play sound after task is completed</code> (<input type="checkbox" disabled>)
The sound on screenshot is removed so one can take a screenshot while recording the audio,
without having the screenshot sound affect the recording.
(TODO image)</li>
</ul>
</li>
</ol>
</li>
<li>
<p><strong>Add the <code>ffmpeg-to-webp</code> action</strong>:</p>
<blockquote>
<p><strong>Explanation:</strong>
This action saves the image as a webp image, to reduce file space while retaining the same quality.
Unfortunately, as of writing this,
<a href="https://github.com/ShareX/ShareX/issues/6090">ShareX does not support webp natively</a>,
so this action must be explicitly defined to save the image as a webp.</p>
</blockquote>
<ul>
<li>Navigate to the <code>Actions</code> tab.</li>
<li>Check <code>Override actions</code> (<input type="checkbox" disabled checked>)</li>
<li>Click <code>Add...</code>.</li>
<li>
<p>A new window should pop up. Under this new window, fill out the following values:</p>
<details class="example">
<summary>ffmpeg-to-webp action <small>(click here)</small></summary>
<ul>
<li><strong>Name</strong>: <code>ffmpeg-to-webp</code></li>
<li><strong>File path</strong>:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>C:\Program Files\ShareX\ffmpeg.exe
</code></pre></div></li>
<li><strong>Argument</strong>:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>-i "$input" -quality 95 "$output"
</code></pre></div></li>
<li><strong>Output file name extension</strong>:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>webp
</code></pre></div></li>
<li>Check <code>Hidden window</code> (<input type="checkbox" disabled checked>)</li>
<li>Check <code>Delete input file</code> (<input type="checkbox" disabled checked>)</li>
</ul>
<p>(TODO image)</p>
</details>
</li>
</ul>
</li>
<li>
<p><strong>Add the <code>card-add-image</code> action</strong>:</p>
<blockquote>
<p><strong>Explanation:</strong>
This adds the image to the Anki card itself, using Anki-Connect and Python.</p>
</blockquote>
<ul>
<li>Under the <code>Actions</code> tab, click <code>Add...</code>.</li>
<li>
<p>A new window should pop up. Under this new window, fill out the following values:</p>
<details class="example">
<summary>card-add-image action <small>(click here)</small></summary>
<ul>
<li><strong>Name</strong>: <code>card-add-image</code></li>
<li><strong>File path</strong>: (change the path to your exact path to <code>python.exe</code>)
    <div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>C:\PATH\TO\YOUR\PYTHON\EXECUTABLE\python.exe
</code></pre></div><ul>
<li>Your <code>python.exe</code> file is usually under <code>C:\PythonXX\python.exe</code>,
    where <code>XX</code> is the version number.
    If you can't find it, you can always search for <code>python.exe</code> on the search bar,
    and then <a href="https://www.howtogeek.com/670447/how-to-copy-the-full-path-of-a-file-on-windows-10/">copying the full path</a> of the file.</li>
</ul>
</li>
<li><strong>Argument</strong>: (change the path to your exact path to <code>hotkey.py</code>)
    <div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>C:\PATH\TO\YOUR\HOTKEY\FILE\hotkey.py set_picture "$input"
</code></pre></div><ul>
<li>This is the <code>hotkey.py</code> file from the <a href="#prerequisites">prerequisites</a> step.</li>
</ul>
</li>
<li>Check <code>Hidden window</code> (<input type="checkbox" disabled checked>)</li>
</ul>
<p>(TODO image)</p>
</details>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Picture field</p>
<p>The expected name of the picture field is exactly <code>Picture</code>.
If your card uses a different field name, say <code>Image</code>, then the <code>--field-name</code> flag must be used
(change <code>Image</code> to whatever your field name is):
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>C:\PATH\TO\YOUR\HOTKEY\FILE\hotkey.py set_picture "$input" --field-name Image
</code></pre></div>
<p>TODO gif</p>
</div>
</li>
<li>
<p><strong>Test the hotkey</strong>:
    TODO</p>
</li>
</ol>
<h3 id="sharex-screenshot-hotkey-nsfw">ShareX Screenshot Hotkey (NSFW)<a class="headerlink" href="#sharex-screenshot-hotkey-nsfw" title="Permanent link">¶</a></h3>
<p>For people using jp-mining-note or using
<a href="https://github.com/MarvNC/JP-Resources#anki-card-blur">Marv's Anki Card Blur</a>,
you might want to setup a different hotkey to specifically tag the card as NSFW when adding the image.</p>
<p>The following hotkey does the same as the above, while also adding the <code>-NSFW</code> tag to the card.</p>
<ol>
<li>Duplicate the screenshot hotkey above, and set the hotkey to something else (i.e. Shift+F6)</li>
<li>Navigate to the <code>Actions</code> tab.<ul>
<li>Select <code>card-add-image</code> action.</li>
<li>Change the <code>Argument</code> to the following:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>C:\PATH\TO\YOUR\HOTKEY\FILE\hotkey.py set_picture "$input" --nsfw True
</code></pre></div></li>
</ul>
</li>
</ol>
<p>TODO gif</p>
<h3 id="sharex-audio-hotkey">ShareX Audio Hotkey<a class="headerlink" href="#sharex-audio-hotkey" title="Permanent link">¶</a></h3>
<ol>
<li>
<p><strong>Create the hotkey</strong>:</p>
<ul>
<li>Open ShareX, if you haven't already.</li>
<li>On the sidebar to the left, click on <code>Hotkey settings...</code>.
    (TODO image)</li>
<li>Within the Hotkey Settings window, click <code>Add</code>.</li>
<li>Set the task to be <code>Screen record</code> -&gt; <code>Start/Stop screen recording using pre configured region</code>.</li>
<li>Set the hotkey value to whatever you want. For example, <code>F7</code>.</li>
</ul>
<p>(TODO gif)</p>
</li>
<li>
<p><strong>Change the hotkey settings</strong>:</p>
<ol>
<li>
<p>Click on the gear of your new <code>Start/Stop screen recording ...</code> hotkey.
    (TODO image)</p>
</li>
<li>
<p>Navigate to the <code>Task</code> tab.</p>
<ul>
<li>Check <code>Override after capture settings</code> (<input type="checkbox" disabled checked>)</li>
<li>Navigate to the capture tasks dropdown, and only have the following two items selected:<ul>
<li>Save image to file</li>
<li>Perform actions</li>
</ul>
</li>
<li>Check <code>Override screenshots folder</code> (<input type="checkbox" disabled checked>)</li>
<li>Click <code>Browse</code> and select your Anki collection media location.
    Your media location can be found under:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>C:\Users\YOUR_USER_NAME\AppData\Roaming\Anki2\YOUR_ANKI_PROFILE_NAME\collection.media
</code></pre></div>
    This should be the exact same folder as the <code>anki-screenshot</code> hotkey.</li>
<li>To make it easier for you to remember what this hotkey does,
    set the <code>Description</code> to <code>anki-audio</code>.</li>
</ul>
<p>Your <code>Task</code> tab should now look something like this:
(TODO image)</p>
</li>
<li>
<p>Navigate to the <code>Capture</code> tab.</p>
<ul>
<li>Check <code>Override capture settings</code> (<input type="checkbox" disabled checked>)</li>
<li>Click <code>Select region</code>, and select anywhere on the screen.
    This region would preferably not overlap with whatever you want to capture.
    If it does and you attempt to screenshot while using the audio hotkey,
    then the dotted region marked by ShareX will be captured as well.
(TODO image)</li>
</ul>
</li>
<li>
<p>Navigate to the <code>Capture</code> -&gt; <code>Screen recorder</code> tab. Within this, tab, click on the <code>Screen recording options...</code> button to open a new window.</p>
<ul>
<li>Press the <code>Install recorder devices</code> button</li>
<li>Set <code>Video source</code> to <code>None</code></li>
<li>Set <code>Audio source</code> to <code>virtual-audio-capturer</code></li>
<li>Set <code>Audio codec</code> to <code>Opus</code> (This will be configurable later)</li>
<li>Click on the <code>Opus</code> tab right underneath <code>Audio codec</code>, and ensure the quality is set to <code>128k</code>.</li>
<li>Close this new window.</li>
</ul>
</li>
</ol>
</li>
<li>
<p><strong>Add the process audio action(s)</strong>:</p>
<blockquote>
<p><strong>Explanation:</strong>
This adds a ffmpeg call to normalize the audio and remove the beginning silence.
Ideally, we would put these audio filters in the <code>Screen recording options</code> custom commands box.
Unfortunately, if placed there, the flags to normalize the audio ends up cutting off the audio.
Therefore, this action is required to accurately run the desired audio filters.</p>
</blockquote>
<p>You have two options:</p>
<ol>
<li><strong>Store as Opus.</strong>
    The <a href="https://opus-codec.org/">Opus</a> audio codec provides much better quality at lower bitrates
    (which saves a lot of space and makes syncing large collections faster).
    <strong>However, Opus is NOT compatible with AnkiMobile (iOS), Android 4, and AnkiWeb.</strong>
    If you use any of these, please use the 2nd option (MP3 audio) below.</li>
<li><strong>Store as MP3.</strong>
    Older and less efficient codec, but needed for compatibility with pretty much all devices.</li>
</ol>
<details class="info">
<summary>Option 1. Opus <small>(click here)</small></summary>
<blockquote>
<p><strong>Explanation:</strong>
ShareX does not natively support storing audio as .wav or .flac files.
ShareX does not provide a simply way to copy a file.
FFmpeg does not allow us to read and write to the exact same file.
Finally, ShareX cannot run the audio filters in the <code>Screen recording options</code> custom commands box,
as mentioned above.
With all these limitations, the only way to store it as opus while running the audio filters is
to first convert the file to something else (we use .wav), and then
re-convert it back to opus again while applying the audio filters.</p>
</blockquote>
<ul>
<li>Navigate to the <code>Actions</code> tab.</li>
<li>Check <code>Override actions</code> (<input type="checkbox" disabled checked>)</li>
<li>
<p>Create the first action, by clicking <code>Add...</code>.
    A new window should pop up. Under this new window, fill out the following values:</p>
<details class="example">
<summary>ffmpeg-process-audio-wav action <small>(click here)</small></summary>
<ul>
<li><strong>Name</strong>: <code>ffmpeg-process-audio-wav</code></li>
<li><strong>File path</strong>:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>C:\Program Files\ShareX\ffmpeg.exe
</code></pre></div></li>
<li><strong>Argument</strong>:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>-y -i "$input" "$output"
</code></pre></div></li>
<li><strong>Output file name extension</strong>:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>wav
</code></pre></div></li>
<li>Check <code>Hidden window</code> (<input type="checkbox" disabled checked>)</li>
<li>Check <code>Delete input file</code> (<input type="checkbox" disabled checked>)</li>
</ul>
<p>(TODO image)</p>
</details>
</li>
<li>
<p>Close the above <code>ffmpeg-process-audio-wav</code> action window.</p>
</li>
<li>
<p>Create the second action, by clicking <code>Add...</code>.
    A new window should pop up. Under this new window, fill out the following values:</p>
<details class="example">
<summary>ffmpeg-process-audio-opus action <small>(click here)</small></summary>
<ul>
<li><strong>Name</strong>: <code>ffmpeg-process-audio-opus</code></li>
<li><strong>File path</strong>:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>C:\Program Files\ShareX\ffmpeg.exe
</code></pre></div></li>
<li><strong>Argument</strong>:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>-y -c:a opus -i "$input" -af "silenceremove=1:0:-50dB, loudnorm=I=-16:TP=-6.2:LRA=11:dual_mono=true" -b:a 64k "$output"
</code></pre></div></li>
<li><strong>Output file name extension</strong>:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>opus
</code></pre></div></li>
<li>Check <code>Hidden window</code> (<input type="checkbox" disabled checked>)</li>
<li>Check <code>Delete input file</code> (<input type="checkbox" disabled checked>)</li>
</ul>
<p>(TODO image)</p>
</details>
</li>
</ul>
</details>
<details class="info">
<summary>Option 2. MP3 <small>(click here)</small></summary>
<ul>
<li>Navigate to the <code>Actions</code> tab.</li>
<li>Check <code>Override actions</code> (<input type="checkbox" disabled checked>)</li>
<li>Click <code>Add...</code>.</li>
<li>
<p>A new window should pop up. Under this new window, fill out the following values:</p>
<details class="example">
<summary>ffmpeg-process-audio-mp3 action <small>(click here)</small></summary>
<ul>
<li><strong>Name</strong>: <code>ffmpeg-process-audio-mp3</code></li>
<li><strong>File path</strong>:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>C:\Program Files\ShareX\ffmpeg.exe
</code></pre></div></li>
<li><strong>Argument</strong>:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>-y -i "$input" -af "silenceremove=1:0:-50dB, loudnorm=I=-16:TP=-6.2:LRA=11:dual_mono=true" -q:a 3 "$output"
</code></pre></div></li>
<li><strong>Output file name extension</strong>:
    <div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>mp3
</code></pre></div></li>
<li>Check <code>Hidden window</code> (<input type="checkbox" disabled checked>)</li>
<li>Check <code>Delete input file</code> (<input type="checkbox" disabled checked>)</li>
</ul>
<p>(TODO image)</p>
</details>
</li>
</ul>
</details>
</li>
<li>
<p><strong>Add the <code>card-add-audio</code> action</strong>:</p>
<p>This adds the image to the Anki card itself.</p>
<ul>
<li>Under the <code>Actions</code> tab, click <code>Add...</code>.</li>
<li>
<p>A new window should pop up. Under this new window, fill out the following values:</p>
<details class="example">
<summary>card-add-audio action <small>(click here)</small></summary>
<ul>
<li><strong>Name</strong>: <code>card-add-audio</code></li>
<li><strong>File path</strong>: (change the path to your exact path to <code>python.exe</code>)
    <div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>C:\PATH\TO\YOUR\PYTHON\EXECUTABLE\python.exe
</code></pre></div></li>
<li><strong>Argument</strong>: (change the path to your exact path to <code>hotkey.py</code>)
    <div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>C:\PATH\TO\YOUR\HOTKEY\FILE\hotkey.py set_audio "$input"
</code></pre></div><ul>
<li>These paths should be the exact same as the <code>card-add-audio</code> action
    within the <code>anki-screenshot</code> hotkey.</li>
</ul>
</li>
<li>Check <code>Hidden window</code> (<input type="checkbox" disabled checked>)</li>
</ul>
<p>(TODO image)</p>
</details>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Sentence Audio field</p>
<p>The expected name of the sentence audio field is exactly <code>SentenceAudio</code>.
If your card uses a different field name, say <code>SentAudio</code>, then the <code>--field-name</code> flag must be used
(change <code>SentAudio</code> to whatever your field name is):
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>"$input" set_audio --field-name SentAudio
</code></pre></div>
<p>TODO gif</p>
</div>
</li>
</ol>
<h3 id="troubleshooting">Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permanent link">¶</a></h3>
<ul>
<li>
<p>Do NOT view the card in the card browser when running any script,
    because if you do, the affected fields may not update.
    Close the card browser before running the scripts.</p>
<p>However, you do not need to worry about this
if you are running the python script with the <code>--enable-gui-browse</code> flag.</p>
</li>
</ul>
<hr>
<h2 id="other-hotkeys">Other Hotkeys<a class="headerlink" href="#other-hotkeys" title="Permanent link">¶</a></h2>
<p>These are a set of scripts that may help you to prevent doing repetitive actions when
adding notes.</p>
<p>Unlike the above, these scripts are not meant to be used with audio or picture files.
Rather, they are stand-alone scripts that modify the most recent cards added.</p>
<p>These scripts are written in two formats:
one that works automatically with your usual <code>ShareX</code> setup,
and one in Python for cross-platform portability.</p>
<hr>
<h3 id="how-to-running-with-sharex">How-To: Running with ShareX<a class="headerlink" href="#how-to-running-with-sharex" title="Permanent link">¶</a></h3>
<p>As shown above, ShareX has the ability to run custom user scripts.
However, for ShareX to only run the script and do nothing else,
the hotkey must be configured with steps shown below.</p>
<!--

!!! warning

    Depending on the popularity of these scripts, the ShareX versions may be deprecated
    in the future in favor of the easier to use/write/maintain Python versions.
    The only downside of using the Python script is that the user must have Python installed.

-->

<h4 id="steps">Steps<a class="headerlink" href="#steps" title="Permanent link">¶</a></h4>
<p>(TODO video)</p>
<ol>
<li>Under the main window, go to <code>Hotkey Settings</code>, and add a new hotkey.</li>
<li>Click on the settings icon (of the newly added hotkey).</li>
<li>In the <code>Task</code> tab (to the left):<ul>
<li>Set: <code>Task</code> to <code>Screen capture</code> →  <code>Capture active window</code></li>
<li>Check <code>Override After Capture Tasks</code> (<input type="checkbox" disabled checked>)</li>
<li>Under <code>After Capture</code>, un-check everything, and check the following:<ul>
<li><code>Save Image to File</code></li>
<li><code>Perform Actions</code></li>
<li><code>Delete Locally</code></li>
</ul>
</li>
</ul>
</li>
<li>In the <code>Actions</code> tab (to the left):<ul>
<li>Check <code>Override Actions</code> (<input type="checkbox" disabled checked>)</li>
<li>Uncheck all existing actions.</li>
<li>Add a new action by clicking on <code>Add</code>.</li>
<li>Set the following values of the action:<ul>
<li>File Path: <code>C:\PATH\TO\python.exe</code></li>
<li>Argument: <code>C:\PATH\TO\YOUR\HOTKEY\FILE\hotkey.py FUNCTION_NAME</code></li>
</ul>
</li>
</ul>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are adding multiple scripts with ShareX, instead of re-doing all of the
steps above, you can instead duplicate the keybind,
and simply set the <code>Argument</code> of the action to a different function name.</p>
</div>
<details class="info">
<summary>Explanation of the setup <small>(click here)</small></summary>
<p>The reason that the <code>After Capture</code> settings include <code>Save Image to File</code>
and <code>Delete Locally</code> is because without those settings, the <code>Perform Actions</code>
section doesn't appear to run.
Fortunately, the combination of <code>Save Image to File</code>
and <code>Delete Locally</code> means the hotkey does the following:</p>
<ul>
<li>Saves the image file</li>
<li>Runs the custom script</li>
<li>Deletes the image file</li>
</ul>
<p>In other words, the image file is only temporarily created,
and then deleted immediately after running the script.
This effectively means that ShareX is only running the script
whenever the keybind is used.</p>
</details>
<hr>
<h3 id="how-to-running-with-command-line">How-To: Running with Command Line<a class="headerlink" href="#how-to-running-with-command-line" title="Permanent link">¶</a></h3>
<p>If you don't want to use ShareX, or you are not using Windows,
you can simply run a python script with command line.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="c1"># Your python version should be 3.9 or higher.</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="c1"># It may work for lower python versions, but I make no guarantee.</span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>python3<span class="w"> </span>/path/to/jp-mining-note/tools/hotkey.py<span class="w"> </span>FUNCTION_NAME
</code></pre></div>
<details class="example">
<summary>Examples <small>(click here)</small></summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="c1"># default</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>python3<span class="w"> </span>/path/to/jp-mining-note/tools/hotkey.py<span class="w"> </span>update_sentence
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="c1"># opens card browser automatically</span>
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>python3<span class="w"> </span>/path/to/jp-mining-note/tools/hotkey.py<span class="w"> </span>update_sentence<span class="w"> </span>--enable-gui-browse
</code></pre></div>
</details>
<p>If you want to use these as keybinds, I will leave it up to you to determine
how to do that (as there are too many different setups and programs that people can use to create keybinds).
However, some tips for ShareX and AutoKey are given below.</p>
<h3 id="how-to-running-with-autokey">How-To: Running with AutoKey <small>(Not AutoHotKey)</small><a class="headerlink" href="#how-to-running-with-autokey" title="Permanent link">¶</a></h3>
<p>If you are using <a href="https://github.com/autokey/autokey">AutoKey</a> for Linux, it should be possible to do the following instead:</p>
<ol>
<li>
<p>Go to: <br>
    <code>Settings</code> <br>
    →  <code>Configure AutoKey</code> <br>
    →  <code>Script Engine</code> <br>
    →  <code>User Module file</code> <br>
    →  (add the <code>jp-mining-note/tools</code> directory)</p>
</li>
<li>
<p>Create a <code>script</code> type hotkey,</p>
</li>
<li>
<p>Within the script, run any function thusly:
    </p><div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="kn">import</span> <span class="nn">hotkey</span>
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="n">hotkey</span><span class="o">.</span><span class="n">FUNCTION_NAME</span><span class="p">()</span>
</code></pre></div>
<p>Example:
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="kn">import</span> <span class="nn">hotkey</span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="n">hotkey</span><span class="o">.</span><span class="n">update_sentence</span><span class="p">()</span>
</code></pre></div>
<p>Example with GUI:
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="kn">import</span> <span class="nn">hotkey</span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="n">hotkey</span><span class="o">.</span><span class="n">_browse_anki</span><span class="p">(</span><span class="s2">"nid:1"</span><span class="p">)</span>
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="n">note_id</span> <span class="o">=</span> <span class="n">hotkey</span><span class="o">.</span><span class="n">update_sentence</span><span class="p">()</span>
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="n">hotkey</span><span class="o">.</span><span class="n">_browse_anki</span><span class="p">(</span><span class="sa">f</span><span class="s2">"nid:</span><span class="si">{</span><span class="n">note_id</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div>
</li>
</ol>
<hr>
<!-- shift + f3 -->
<h3 class="text-yellow" id="update-sentence-with-clipboard">Update Sentence with Clipboard<a class="headerlink" href="#update-sentence-with-clipboard" title="Permanent link">¶</a></h3>
<blockquote>
<p><em>Function Name</em>: <code>update_sentence</code></p>
</blockquote>
<p>This script updates the sentence with the current clipboard (while preserving the bolded word),
and removes the <code>SentenceReading</code> field (of the newest note added).</p>
<p>This script is useful when Yomichan's parsed sentence does not match the recorded audio.
This is also useful for when Yomichan's word parser doesn't match the word itself (steps shown below).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>After running this script, you must manually generate the <code>SentenceReading</code> field
if you want the furigana reading.
Of course, this can be done in bulk at any point,
as shown <a href="../faq/#how-do-i-bulk-generate-furigana">here</a>.</p>
</div>
<details class="info">
<summary>How-To: Fix incorrectly-bolded words <small>(click here)</small></summary>
<p>As an example, The target word 希望 in the sentence 「入部希望なんですけど…」
will be parsed by Yomichan as the following:
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>入部&lt;b&gt;希望な&lt;/b&gt;んですけど…
</code></pre></div>
<p>Within the original popup, you can add two versions of the word by default:</p>
<ol>
<li>The one with JMdict only.
    Adding this word will add the sentence with incorrect bolding.</li>
<li>The one with everything else other than JMdict.
    Adding this word will have the correct bold, but will be missing some definitions.</li>
</ol>
<p>To add the above sentence that solves both problems (no weird bold, and contains all definitions),
do NOT add the word within the sentence.
Instead, do the following:</p>
<ol>
<li>
<p>Highlight over the header word itself (or the word in the orthographic forms dictionary),
    and add that word instead.</p>
<details class="example">
<summary>Demo <small>(click here)</small></summary>
<p><a href="../assets/jpresources/incorrect_bold.png"><img alt="Add the definition from the popup dictionary" src="../assets/jpresources/incorrect_bold.png"></a></p>
</details>
</li>
<li>
<p>Copy the desired sentence.</p>
</li>
<li>
<p>Run this script.</p>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is assumed that you have
<a href="https://learnjapanese.moe/monolingual/#optimizing-yomichan-settings">multiple popups enabled</a>.</p>
</div>
</details>
<details class="info">
<summary>How the bolded word is preserved <small>(click here)</small></summary>
<p>The bolded word is preserved if the exact content within the bolded word is found within the clipboard,
which should be almost always the case.</p>
<p>For example, assume the added sentence is the following:
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>さては<span class="p">&lt;</span><span class="nt">b</span><span class="p">&gt;</span>偽者<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;</span>だな！
</code></pre></div>
<p>As long as the clipboard contains the word 「偽者」, then the bold is preserved.
For example, the following clipboard contents will preserve the bold:
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>かわいげのある女じゃない。さては偽者だな！
</code></pre></div>
</details>
<p>TODO <code>sharex_display(sharex.update_sentence)</code></p>
<hr>
<h3 class="text-yellow" id="update-additionalnotes-with-clipboard">Update AdditionalNotes with Clipboard<a class="headerlink" href="#update-additionalnotes-with-clipboard" title="Permanent link">¶</a></h3>
<blockquote>
<p><em>Function Name</em>: <code>update_additional_notes</code></p>
</blockquote>
<p>This script does the exact same thing as the above script, but with
<code>AdditionalNotes</code> instead of <code>Sentence</code>.
The tested word, if found, is also automatically highlighted.</p>
<p>This is useful to copy/paste context for the sentence (the surrounding lines
around the sentence).</p>
<p>TODO <code>sharex_display(sharex.update_additional_notes)</code></p>
<hr>
<!-- ctrl + f3 -->
<h3 class="text-yellow" id="copy-from-previous-card">Copy from Previous Card<a class="headerlink" href="#copy-from-previous-card" title="Permanent link">¶</a></h3>
<blockquote>
<p><em>Function Name</em>: <code>copy_from_previous</code></p>
</blockquote>
<p>This script does the following:</p>
<ul>
<li>Set the <code>AdditionalNotes</code> and <code>Picture</code> field of the newest card to the previous (second-newest) card's fields.</li>
<li>Copies all the tags of the previous card.</li>
</ul>
<p>This is useful for when you are adding more than one sentence with the same text box
of a visual novel, as it prevents you from having to run the screenshot hotkey.</p>
<h4 id="how-to-use">How to use<a class="headerlink" href="#how-to-use" title="Permanent link">¶</a></h4>
<ol>
<li>Create a card from the first unknown word in the text box.</li>
<li>Create a card from the second unknown word in the text box.</li>
<li>Run this script.</li>
</ol>
<p>TODO <code>sharex_display(sharex.copy_from_previous)</code></p>
<hr>
<!-- ctrl + shift + f3 -->
<h3 class="text-yellow" id="orthographic-variants-fix-sentence-and-frequency">Orthographic Variants: Fix Sentence and Frequency<a class="headerlink" href="#orthographic-variants-fix-sentence-and-frequency" title="Permanent link">¶</a></h3>
<blockquote>
<p><em>Function Name</em>: <code>fix_sent_and_freq</code></p>
</blockquote>
<p>This script does the following:</p>
<ul>
<li>Sets the previous note's fields to the newest note's fields:<ul>
<li><code>FrequencyStylized</code></li>
<li><code>Sentence</code></li>
<li><code>SentenceReading</code></li>
</ul>
</li>
<li>Deletes the newest note</li>
</ul>
<p>This is useful for when you want to add the the word within the
<a href="https://github.com/FooSoft/yomichan/issues/2183">Orthographic Variants</a> dictionary.
The Orthographics Variants dictionary is extremely useful for monolingual definitions,
where dictionaries only contain entries for more kanjified words.</p>
<p>In practice, I've personally found numerous examples of this in everyday media,
so this has helped me immensely.</p>
<details class="example">
<summary>Examples (to test the dictionary on)</summary>
<p class="jp-quote-text">「スペルド族への恐怖は恐らくこの世界に<b class="jpmn-highlight">根づいている</b>んだろう」</p>
<p class="jp-quote-text">「ルーはたくさんあるので、今<b class="jpmn-highlight">お代わり</b>をお持ちしますね」</p>
<p class="jp-quote-text">「ただ、一つだけ<b class="jpmn-highlight">釘をささせて</b>もらうけど…貴方がこれから何をするにしても、仕事は今まで通りこなしてもらうわよ？」</p>
<p>It is assumed that you have
<a href="https://learnjapanese.moe/monolingual/#optimizing-yomichan-settings">multiple popups enabled</a>
for monolingual definitions, so you can easily look up the word in the
Orthographic Forms dictionary.</p>
</details>
<h4 id="how-to-use_1">How to use<a class="headerlink" href="#how-to-use_1" title="Permanent link">¶</a></h4>
<ol>
<li>Create a card from the word in the Orthographic Variants dictionary.</li>
<li>Create a card from the word in original sentence.</li>
<li>Run this script.</li>
</ol>
<hr>
<h2 id="deprecated-scripts">Deprecated Scripts<a class="headerlink" href="#deprecated-scripts" title="Permanent link">¶</a></h2>
<p>These contain powershell code for some scripts above.
This powershell code has been replaced with Python scripts for easier maintainability</p>
<details class="info">
<summary>Screenshot and Clipboard Hotkey</summary>
<p>Follow the steps for setting up the
<a href="https://rentry.co/mining#hotkey-for-screenshot">screenshot hotkey</a>,
and use this script in place of step 8's <code>argument</code>.</p>
<div class="admonition example">
<p class="admonition-title">ShareX Script</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>-NoProfile -Command "function Run-Json { param( $json_map ); $json = $json_map | ConvertTo-Json -Depth 5; $data = Invoke-RestMethod -Uri http://127.0.0.1:8765 -Method Post -ContentType 'application/json; charset=UTF-8' -Body $json; return $data; }; $clipboard = (Get-Clipboard | where{$_ -ne \"\"}) -join \"&lt;br&gt;\"; $media_name = '$input' | Split-Path -leaf; $added_notes = Run-Json @{ action = 'findNotes'; version = 6; params = @{ query = 'added:1'; } }; $sorted_list = $added_notes.result | Sort-Object -Descending {[Long]$_}; $curr_note_id = $sorted_list[0]; $curr_note_data = Run-Json @{ action = 'notesInfo'; version = 6; params = @{ notes = @($curr_note_id); } }; $curr_note_sent = $curr_note_data.result.fields.Sentence.value; $result_clipboard = $clipboard; if ($curr_note_sent -match '&lt;b&gt;(?&lt;bolded&gt;.+)&lt;/b&gt;') { $bolded = $matches['bolded']; $result_clipboard = $clipboard.replace($bolded, \"&lt;b&gt;$bolded&lt;/b&gt;\"); }; Run-Json @{ action = 'updateNoteFields'; version = 6; params = @{ note = @{ id = $curr_note_id; fields = @{ Picture = \"&lt;img data-editor-shrink=`\"true`\" src=`\"$media_name`\"&gt;\"; AdditionalNotes = $result_clipboard; } } } }; if ($media_name -match '(?&lt;tag&gt;.+)_.*') { $tag = $matches['tag']; } Run-Json @{ action = 'addTags'; version = 6; params = @{ notes = @($curr_note_id); tags = $tag; } };"
</code></pre></div>
</div>
<details class="example">
<summary>Original ShareX Code <small>(click here)</small></summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="c"># (common begin)</span>
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a><span class="k">function</span> <span class="n">Run-Json</span> <span class="p">{</span>
<a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a>    <span class="k">param</span><span class="p">(</span> <span class="nv">$json_map</span> <span class="p">);</span>
<a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a>
<a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a>    <span class="nv">$json</span> <span class="p">=</span> <span class="nv">$json_map</span> <span class="p">|</span> <span class="nb">ConvertTo-Json</span> <span class="n">-Depth</span> <span class="n">5</span><span class="p">;</span>
<a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a>    <span class="nv">$data</span> <span class="p">=</span> <span class="nb">Invoke-RestMethod</span> <span class="n">-Uri</span> <span class="n">http</span><span class="p">://</span><span class="n">127</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">1</span><span class="p">:</span><span class="n">8765</span> <span class="n">-Method</span> <span class="n">Post</span> <span class="n">-ContentType</span> <span class="p">`</span>
<a id="__codelineno-32-8" name="__codelineno-32-8" href="#__codelineno-32-8"></a>        <span class="s1">'application/json; charset=UTF-8'</span> <span class="n">-Body</span> <span class="nv">$json</span><span class="p">;</span>
<a id="__codelineno-32-9" name="__codelineno-32-9" href="#__codelineno-32-9"></a>
<a id="__codelineno-32-10" name="__codelineno-32-10" href="#__codelineno-32-10"></a>    <span class="k">return</span> <span class="nv">$data</span><span class="p">;</span>
<a id="__codelineno-32-11" name="__codelineno-32-11" href="#__codelineno-32-11"></a><span class="p">};</span>
<a id="__codelineno-32-12" name="__codelineno-32-12" href="#__codelineno-32-12"></a>
<a id="__codelineno-32-13" name="__codelineno-32-13" href="#__codelineno-32-13"></a><span class="c"># (common end)</span>
<a id="__codelineno-32-14" name="__codelineno-32-14" href="#__codelineno-32-14"></a>
<a id="__codelineno-32-15" name="__codelineno-32-15" href="#__codelineno-32-15"></a>
<a id="__codelineno-32-16" name="__codelineno-32-16" href="#__codelineno-32-16"></a>
<a id="__codelineno-32-17" name="__codelineno-32-17" href="#__codelineno-32-17"></a><span class="nv">$clipboard</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Get-Clipboard</span> <span class="p">|</span> <span class="n">where</span><span class="p">{</span><span class="nv">$_</span> <span class="o">-ne</span> <span class="s2">""</span><span class="p">})</span> <span class="n">-join</span> <span class="s2">"&lt;br&gt;"</span><span class="p">;</span>
<a id="__codelineno-32-18" name="__codelineno-32-18" href="#__codelineno-32-18"></a>
<a id="__codelineno-32-19" name="__codelineno-32-19" href="#__codelineno-32-19"></a><span class="c"># gets only the file name</span>
<a id="__codelineno-32-20" name="__codelineno-32-20" href="#__codelineno-32-20"></a><span class="nv">$media_name</span> <span class="p">=</span> <span class="s1">'$input'</span> <span class="p">|</span> <span class="nb">Split-Path</span> <span class="n">-leaf</span><span class="p">;</span>
<a id="__codelineno-32-21" name="__codelineno-32-21" href="#__codelineno-32-21"></a>
<a id="__codelineno-32-22" name="__codelineno-32-22" href="#__codelineno-32-22"></a><span class="nv">$added_notes</span> <span class="p">=</span> <span class="n">Run-Json</span> <span class="p">@{</span>
<a id="__codelineno-32-23" name="__codelineno-32-23" href="#__codelineno-32-23"></a>    <span class="n">action</span> <span class="p">=</span> <span class="s1">'findNotes'</span><span class="p">;</span>
<a id="__codelineno-32-24" name="__codelineno-32-24" href="#__codelineno-32-24"></a>    <span class="n">version</span> <span class="p">=</span> <span class="n">6</span><span class="p">;</span>
<a id="__codelineno-32-25" name="__codelineno-32-25" href="#__codelineno-32-25"></a>    <span class="n">params</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-32-26" name="__codelineno-32-26" href="#__codelineno-32-26"></a>        <span class="n">query</span> <span class="p">=</span> <span class="s1">'added:1'</span><span class="p">;</span>
<a id="__codelineno-32-27" name="__codelineno-32-27" href="#__codelineno-32-27"></a>    <span class="p">}</span>
<a id="__codelineno-32-28" name="__codelineno-32-28" href="#__codelineno-32-28"></a><span class="p">};</span>
<a id="__codelineno-32-29" name="__codelineno-32-29" href="#__codelineno-32-29"></a>
<a id="__codelineno-32-30" name="__codelineno-32-30" href="#__codelineno-32-30"></a><span class="nv">$sorted_list</span> <span class="p">=</span> <span class="nv">$added_notes</span><span class="p">.</span><span class="n">result</span> <span class="p">|</span> <span class="nb">Sort-Object</span> <span class="n">-Descending</span> <span class="p">{</span><span class="no">[Long]</span><span class="nv">$_</span><span class="p">};</span>
<a id="__codelineno-32-31" name="__codelineno-32-31" href="#__codelineno-32-31"></a>
<a id="__codelineno-32-32" name="__codelineno-32-32" href="#__codelineno-32-32"></a><span class="nv">$curr_note_id</span> <span class="p">=</span> <span class="nv">$sorted_list</span><span class="p">[</span><span class="n">0</span><span class="p">];</span>
<a id="__codelineno-32-33" name="__codelineno-32-33" href="#__codelineno-32-33"></a>
<a id="__codelineno-32-34" name="__codelineno-32-34" href="#__codelineno-32-34"></a>
<a id="__codelineno-32-35" name="__codelineno-32-35" href="#__codelineno-32-35"></a><span class="c"># attempts to bold the found word within the clipboard</span>
<a id="__codelineno-32-36" name="__codelineno-32-36" href="#__codelineno-32-36"></a><span class="nv">$curr_note_data</span> <span class="p">=</span> <span class="n">Run-Json</span> <span class="p">@{</span>
<a id="__codelineno-32-37" name="__codelineno-32-37" href="#__codelineno-32-37"></a>    <span class="n">action</span> <span class="p">=</span> <span class="s1">'notesInfo'</span><span class="p">;</span>
<a id="__codelineno-32-38" name="__codelineno-32-38" href="#__codelineno-32-38"></a>    <span class="n">version</span> <span class="p">=</span> <span class="n">6</span><span class="p">;</span>
<a id="__codelineno-32-39" name="__codelineno-32-39" href="#__codelineno-32-39"></a>    <span class="n">params</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-32-40" name="__codelineno-32-40" href="#__codelineno-32-40"></a>        <span class="n">notes</span> <span class="p">=</span> <span class="p">@(</span><span class="nv">$curr_note_id</span><span class="p">);</span>
<a id="__codelineno-32-41" name="__codelineno-32-41" href="#__codelineno-32-41"></a>    <span class="p">}</span>
<a id="__codelineno-32-42" name="__codelineno-32-42" href="#__codelineno-32-42"></a><span class="p">};</span>
<a id="__codelineno-32-43" name="__codelineno-32-43" href="#__codelineno-32-43"></a><span class="nv">$curr_note_sent</span> <span class="p">=</span> <span class="nv">$curr_note_data</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">fields</span><span class="p">.</span><span class="n">Sentence</span><span class="p">.</span><span class="n">value</span><span class="p">;</span>
<a id="__codelineno-32-44" name="__codelineno-32-44" href="#__codelineno-32-44"></a><span class="nv">$result_clipboard</span> <span class="p">=</span> <span class="nv">$clipboard</span><span class="p">;</span>
<a id="__codelineno-32-45" name="__codelineno-32-45" href="#__codelineno-32-45"></a><span class="k">if</span> <span class="p">(</span><span class="nv">$curr_note_sent</span> <span class="o">-match</span> <span class="s1">'&lt;b&gt;(?&lt;bolded&gt;.+)&lt;/b&gt;'</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-32-46" name="__codelineno-32-46" href="#__codelineno-32-46"></a>    <span class="nv">$bolded</span> <span class="p">=</span> <span class="nv">$matches</span><span class="p">[</span><span class="s1">'bolded'</span><span class="p">];</span>
<a id="__codelineno-32-47" name="__codelineno-32-47" href="#__codelineno-32-47"></a>    <span class="c"># may not replace anything</span>
<a id="__codelineno-32-48" name="__codelineno-32-48" href="#__codelineno-32-48"></a>    <span class="nv">$result_clipboard</span> <span class="p">=</span> <span class="nv">$clipboard</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="nv">$bolded</span><span class="p">,</span> <span class="s2">"&lt;b&gt;$bolded&lt;/b&gt;"</span><span class="p">);</span>
<a id="__codelineno-32-49" name="__codelineno-32-49" href="#__codelineno-32-49"></a><span class="p">};</span>
<a id="__codelineno-32-50" name="__codelineno-32-50" href="#__codelineno-32-50"></a>
<a id="__codelineno-32-51" name="__codelineno-32-51" href="#__codelineno-32-51"></a>
<a id="__codelineno-32-52" name="__codelineno-32-52" href="#__codelineno-32-52"></a>
<a id="__codelineno-32-53" name="__codelineno-32-53" href="#__codelineno-32-53"></a><span class="n">Run-Json</span> <span class="p">@{</span>
<a id="__codelineno-32-54" name="__codelineno-32-54" href="#__codelineno-32-54"></a>    <span class="n">action</span> <span class="p">=</span> <span class="s1">'updateNoteFields'</span><span class="p">;</span>
<a id="__codelineno-32-55" name="__codelineno-32-55" href="#__codelineno-32-55"></a>    <span class="n">version</span> <span class="p">=</span> <span class="n">6</span><span class="p">;</span>
<a id="__codelineno-32-56" name="__codelineno-32-56" href="#__codelineno-32-56"></a>    <span class="n">params</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-32-57" name="__codelineno-32-57" href="#__codelineno-32-57"></a>        <span class="n">note</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-32-58" name="__codelineno-32-58" href="#__codelineno-32-58"></a>            <span class="n">id</span> <span class="p">=</span> <span class="nv">$curr_note_id</span><span class="p">;</span>
<a id="__codelineno-32-59" name="__codelineno-32-59" href="#__codelineno-32-59"></a>            <span class="n">fields</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-32-60" name="__codelineno-32-60" href="#__codelineno-32-60"></a>                <span class="n">Picture</span> <span class="p">=</span> <span class="s2">"&lt;img data-editor-shrink=</span><span class="se">`"</span><span class="s2">true</span><span class="se">`"</span><span class="s2"> src=</span><span class="se">`"</span><span class="s2">$media_name</span><span class="se">`"</span><span class="s2">&gt;"</span><span class="p">;</span>
<a id="__codelineno-32-61" name="__codelineno-32-61" href="#__codelineno-32-61"></a>                <span class="n">AdditionalNotes</span> <span class="p">=</span> <span class="nv">$result_clipboard</span><span class="p">;</span>
<a id="__codelineno-32-62" name="__codelineno-32-62" href="#__codelineno-32-62"></a>            <span class="p">}</span>
<a id="__codelineno-32-63" name="__codelineno-32-63" href="#__codelineno-32-63"></a>        <span class="p">}</span>
<a id="__codelineno-32-64" name="__codelineno-32-64" href="#__codelineno-32-64"></a>    <span class="p">}</span>
<a id="__codelineno-32-65" name="__codelineno-32-65" href="#__codelineno-32-65"></a><span class="p">};</span>
<a id="__codelineno-32-66" name="__codelineno-32-66" href="#__codelineno-32-66"></a>
<a id="__codelineno-32-67" name="__codelineno-32-67" href="#__codelineno-32-67"></a><span class="k">if</span> <span class="p">(</span><span class="nv">$media_name</span> <span class="o">-match</span> <span class="s1">'(?&lt;tag&gt;.+)_.*'</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-32-68" name="__codelineno-32-68" href="#__codelineno-32-68"></a>    <span class="nv">$tag</span> <span class="p">=</span> <span class="nv">$matches</span><span class="p">[</span><span class="s1">'tag'</span><span class="p">];</span>
<a id="__codelineno-32-69" name="__codelineno-32-69" href="#__codelineno-32-69"></a><span class="p">}</span>
<a id="__codelineno-32-70" name="__codelineno-32-70" href="#__codelineno-32-70"></a>
<a id="__codelineno-32-71" name="__codelineno-32-71" href="#__codelineno-32-71"></a><span class="n">Run-Json</span> <span class="p">@{</span>
<a id="__codelineno-32-72" name="__codelineno-32-72" href="#__codelineno-32-72"></a>    <span class="n">action</span> <span class="p">=</span> <span class="s1">'addTags'</span><span class="p">;</span>
<a id="__codelineno-32-73" name="__codelineno-32-73" href="#__codelineno-32-73"></a>    <span class="n">version</span> <span class="p">=</span> <span class="n">6</span><span class="p">;</span>
<a id="__codelineno-32-74" name="__codelineno-32-74" href="#__codelineno-32-74"></a>    <span class="n">params</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-32-75" name="__codelineno-32-75" href="#__codelineno-32-75"></a>        <span class="n">notes</span> <span class="p">=</span> <span class="p">@(</span><span class="nv">$curr_note_id</span><span class="p">);</span>
<a id="__codelineno-32-76" name="__codelineno-32-76" href="#__codelineno-32-76"></a>        <span class="n">tags</span> <span class="p">=</span> <span class="nv">$tag</span><span class="p">;</span>
<a id="__codelineno-32-77" name="__codelineno-32-77" href="#__codelineno-32-77"></a>    <span class="p">}</span>
<a id="__codelineno-32-78" name="__codelineno-32-78" href="#__codelineno-32-78"></a><span class="p">};</span>
</code></pre></div>
</details>
</details>
<details class="info">
<summary>Screenshot (only) Hotkey</summary>
<p>This is the same as the above, but without setting the <code>AdditionalNotes</code> field to the current clipboard.</p>
<div class="admonition example">
<p class="admonition-title">ShareX Script</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>-NoProfile -Command "function Run-Json { param( $json_map ); $json = $json_map | ConvertTo-Json -Depth 5; $data = Invoke-RestMethod -Uri http://127.0.0.1:8765 -Method Post -ContentType 'application/json; charset=UTF-8' -Body $json; return $data; }; $media_name = '$input' | Split-Path -leaf; $added_notes = Run-Json @{ action = 'findNotes'; version = 6; params = @{ query = 'added:1'; } }; $sorted_list = $added_notes.result | Sort-Object -Descending {[Long]$_}; $curr_note_id = $sorted_list[0]; Run-Json @{ action = 'updateNoteFields'; version = 6; params = @{ note = @{ id = $curr_note_id; fields = @{ Picture = \"&lt;img data-editor-shrink=`\"true`\" src=`\"$media_name`\"&gt;\"; } } } }; if ($media_name -match '(?&lt;tag&gt;.+)_.*') { $tag = $matches['tag'] } Run-Json @{ action = 'addTags'; version = 6; params = @{ notes = @($curr_note_id); tags = $tag; } };"
</code></pre></div>
</div>
<details class="example">
<summary>Original ShareX Code <small>(click here)</small></summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="c"># (common begin)</span>
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>
<a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a><span class="k">function</span> <span class="n">Run-Json</span> <span class="p">{</span>
<a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a>    <span class="k">param</span><span class="p">(</span> <span class="nv">$json_map</span> <span class="p">);</span>
<a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a>
<a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a>    <span class="nv">$json</span> <span class="p">=</span> <span class="nv">$json_map</span> <span class="p">|</span> <span class="nb">ConvertTo-Json</span> <span class="n">-Depth</span> <span class="n">5</span><span class="p">;</span>
<a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a>    <span class="nv">$data</span> <span class="p">=</span> <span class="nb">Invoke-RestMethod</span> <span class="n">-Uri</span> <span class="n">http</span><span class="p">://</span><span class="n">127</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">1</span><span class="p">:</span><span class="n">8765</span> <span class="n">-Method</span> <span class="n">Post</span> <span class="n">-ContentType</span> <span class="p">`</span>
<a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a>        <span class="s1">'application/json; charset=UTF-8'</span> <span class="n">-Body</span> <span class="nv">$json</span><span class="p">;</span>
<a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a>
<a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a>    <span class="k">return</span> <span class="nv">$data</span><span class="p">;</span>
<a id="__codelineno-34-11" name="__codelineno-34-11" href="#__codelineno-34-11"></a><span class="p">};</span>
<a id="__codelineno-34-12" name="__codelineno-34-12" href="#__codelineno-34-12"></a>
<a id="__codelineno-34-13" name="__codelineno-34-13" href="#__codelineno-34-13"></a><span class="c"># (common end)</span>
<a id="__codelineno-34-14" name="__codelineno-34-14" href="#__codelineno-34-14"></a>
<a id="__codelineno-34-15" name="__codelineno-34-15" href="#__codelineno-34-15"></a>
<a id="__codelineno-34-16" name="__codelineno-34-16" href="#__codelineno-34-16"></a><span class="c"># gets only the file name</span>
<a id="__codelineno-34-17" name="__codelineno-34-17" href="#__codelineno-34-17"></a><span class="nv">$media_name</span> <span class="p">=</span> <span class="s1">'$input'</span> <span class="p">|</span> <span class="nb">Split-Path</span> <span class="n">-leaf</span><span class="p">;</span>
<a id="__codelineno-34-18" name="__codelineno-34-18" href="#__codelineno-34-18"></a>
<a id="__codelineno-34-19" name="__codelineno-34-19" href="#__codelineno-34-19"></a><span class="nv">$added_notes</span> <span class="p">=</span> <span class="n">Run-Json</span> <span class="p">@{</span>
<a id="__codelineno-34-20" name="__codelineno-34-20" href="#__codelineno-34-20"></a>    <span class="n">action</span> <span class="p">=</span> <span class="s1">'findNotes'</span><span class="p">;</span>
<a id="__codelineno-34-21" name="__codelineno-34-21" href="#__codelineno-34-21"></a>    <span class="n">version</span> <span class="p">=</span> <span class="n">6</span><span class="p">;</span>
<a id="__codelineno-34-22" name="__codelineno-34-22" href="#__codelineno-34-22"></a>    <span class="n">params</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-34-23" name="__codelineno-34-23" href="#__codelineno-34-23"></a>        <span class="n">query</span> <span class="p">=</span> <span class="s1">'added:1'</span><span class="p">;</span>
<a id="__codelineno-34-24" name="__codelineno-34-24" href="#__codelineno-34-24"></a>    <span class="p">}</span>
<a id="__codelineno-34-25" name="__codelineno-34-25" href="#__codelineno-34-25"></a><span class="p">};</span>
<a id="__codelineno-34-26" name="__codelineno-34-26" href="#__codelineno-34-26"></a>
<a id="__codelineno-34-27" name="__codelineno-34-27" href="#__codelineno-34-27"></a><span class="nv">$sorted_list</span> <span class="p">=</span> <span class="nv">$added_notes</span><span class="p">.</span><span class="n">result</span> <span class="p">|</span> <span class="nb">Sort-Object</span> <span class="n">-Descending</span> <span class="p">{</span><span class="no">[Long]</span><span class="nv">$_</span><span class="p">};</span>
<a id="__codelineno-34-28" name="__codelineno-34-28" href="#__codelineno-34-28"></a>
<a id="__codelineno-34-29" name="__codelineno-34-29" href="#__codelineno-34-29"></a><span class="nv">$curr_note_id</span> <span class="p">=</span> <span class="nv">$sorted_list</span><span class="p">[</span><span class="n">0</span><span class="p">];</span>
<a id="__codelineno-34-30" name="__codelineno-34-30" href="#__codelineno-34-30"></a>
<a id="__codelineno-34-31" name="__codelineno-34-31" href="#__codelineno-34-31"></a>
<a id="__codelineno-34-32" name="__codelineno-34-32" href="#__codelineno-34-32"></a><span class="n">Run-Json</span> <span class="p">@{</span>
<a id="__codelineno-34-33" name="__codelineno-34-33" href="#__codelineno-34-33"></a>    <span class="n">action</span> <span class="p">=</span> <span class="s1">'updateNoteFields'</span><span class="p">;</span>
<a id="__codelineno-34-34" name="__codelineno-34-34" href="#__codelineno-34-34"></a>    <span class="n">version</span> <span class="p">=</span> <span class="n">6</span><span class="p">;</span>
<a id="__codelineno-34-35" name="__codelineno-34-35" href="#__codelineno-34-35"></a>    <span class="n">params</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-34-36" name="__codelineno-34-36" href="#__codelineno-34-36"></a>        <span class="n">note</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-34-37" name="__codelineno-34-37" href="#__codelineno-34-37"></a>            <span class="n">id</span> <span class="p">=</span> <span class="nv">$curr_note_id</span><span class="p">;</span>
<a id="__codelineno-34-38" name="__codelineno-34-38" href="#__codelineno-34-38"></a>            <span class="n">fields</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-34-39" name="__codelineno-34-39" href="#__codelineno-34-39"></a>                <span class="n">Picture</span> <span class="p">=</span> <span class="s2">"&lt;img data-editor-shrink=</span><span class="se">`"</span><span class="s2">true</span><span class="se">`"</span><span class="s2"> src=</span><span class="se">`"</span><span class="s2">$media_name</span><span class="se">`"</span><span class="s2">&gt;"</span><span class="p">;</span>
<a id="__codelineno-34-40" name="__codelineno-34-40" href="#__codelineno-34-40"></a>            <span class="p">}</span>
<a id="__codelineno-34-41" name="__codelineno-34-41" href="#__codelineno-34-41"></a>        <span class="p">}</span>
<a id="__codelineno-34-42" name="__codelineno-34-42" href="#__codelineno-34-42"></a>    <span class="p">}</span>
<a id="__codelineno-34-43" name="__codelineno-34-43" href="#__codelineno-34-43"></a><span class="p">};</span>
<a id="__codelineno-34-44" name="__codelineno-34-44" href="#__codelineno-34-44"></a>
<a id="__codelineno-34-45" name="__codelineno-34-45" href="#__codelineno-34-45"></a><span class="k">if</span> <span class="p">(</span><span class="nv">$media_name</span> <span class="o">-match</span> <span class="s1">'(?&lt;tag&gt;.+)_.*'</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-34-46" name="__codelineno-34-46" href="#__codelineno-34-46"></a>    <span class="nv">$tag</span> <span class="p">=</span> <span class="nv">$matches</span><span class="p">[</span><span class="s1">'tag'</span><span class="p">]</span>
<a id="__codelineno-34-47" name="__codelineno-34-47" href="#__codelineno-34-47"></a><span class="p">}</span>
<a id="__codelineno-34-48" name="__codelineno-34-48" href="#__codelineno-34-48"></a>
<a id="__codelineno-34-49" name="__codelineno-34-49" href="#__codelineno-34-49"></a><span class="n">Run-Json</span> <span class="p">@{</span>
<a id="__codelineno-34-50" name="__codelineno-34-50" href="#__codelineno-34-50"></a>    <span class="n">action</span> <span class="p">=</span> <span class="s1">'addTags'</span><span class="p">;</span>
<a id="__codelineno-34-51" name="__codelineno-34-51" href="#__codelineno-34-51"></a>    <span class="n">version</span> <span class="p">=</span> <span class="n">6</span><span class="p">;</span>
<a id="__codelineno-34-52" name="__codelineno-34-52" href="#__codelineno-34-52"></a>    <span class="n">params</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-34-53" name="__codelineno-34-53" href="#__codelineno-34-53"></a>        <span class="n">notes</span> <span class="p">=</span> <span class="p">@(</span><span class="nv">$curr_note_id</span><span class="p">);</span>
<a id="__codelineno-34-54" name="__codelineno-34-54" href="#__codelineno-34-54"></a>        <span class="n">tags</span> <span class="p">=</span> <span class="nv">$tag</span><span class="p">;</span>
<a id="__codelineno-34-55" name="__codelineno-34-55" href="#__codelineno-34-55"></a>    <span class="p">}</span>
<a id="__codelineno-34-56" name="__codelineno-34-56" href="#__codelineno-34-56"></a><span class="p">};</span>
</code></pre></div>
</details>
</details>
<details class="info">
<summary>Audio Hotkey</summary>
<p>This script works <em>exactly the same</em> as stegatxins0's version,
except rewritten in a more readable format.
If you already have the audio hotkey setup, there is no reason to change the old script.</p>
<p>To use this, follow the steps for setting up the
<a href="https://rentry.co/mining#hotkey-for-audio">audio hotkey</a>,
and use this script in place of step 14's <code>Argument</code>.</p>
<div class="admonition example">
<p class="admonition-title">ShareX Script</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>-NoProfile -Command "function Run-Json { param( $json_map ); $json = $json_map | ConvertTo-Json -Depth 5; $data = Invoke-RestMethod -Uri http://127.0.0.1:8765 -Method Post -ContentType 'application/json; charset=UTF-8' -Body $json; return $data; }; $media_name = '$input' | Split-Path -leaf; $added_notes = Run-Json @{ action = 'findNotes'; version = 6; params = @{ query = 'added:1'; } }; $sorted_list = $added_notes.result | Sort-Object -Descending {[Long]$_}; $curr_note_id = $sorted_list[0]; Run-Json @{ action = 'updateNoteFields'; version = 6; params = @{ note = @{ id = $curr_note_id; fields = @{ SentenceAudio = \"[sound:$media_name]\"; } } } };"
</code></pre></div>
</div>
<details class="example">
<summary>Original ShareX Code <small>(click here)</small></summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="c"># (common begin)</span>
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>
<a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a><span class="k">function</span> <span class="n">Run-Json</span> <span class="p">{</span>
<a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a>    <span class="k">param</span><span class="p">(</span> <span class="nv">$json_map</span> <span class="p">);</span>
<a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a>
<a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a>    <span class="nv">$json</span> <span class="p">=</span> <span class="nv">$json_map</span> <span class="p">|</span> <span class="nb">ConvertTo-Json</span> <span class="n">-Depth</span> <span class="n">5</span><span class="p">;</span>
<a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a>    <span class="nv">$data</span> <span class="p">=</span> <span class="nb">Invoke-RestMethod</span> <span class="n">-Uri</span> <span class="n">http</span><span class="p">://</span><span class="n">127</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">1</span><span class="p">:</span><span class="n">8765</span> <span class="n">-Method</span> <span class="n">Post</span> <span class="n">-ContentType</span> <span class="p">`</span>
<a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a>        <span class="s1">'application/json; charset=UTF-8'</span> <span class="n">-Body</span> <span class="nv">$json</span><span class="p">;</span>
<a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a>
<a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a>    <span class="k">return</span> <span class="nv">$data</span><span class="p">;</span>
<a id="__codelineno-36-11" name="__codelineno-36-11" href="#__codelineno-36-11"></a><span class="p">};</span>
<a id="__codelineno-36-12" name="__codelineno-36-12" href="#__codelineno-36-12"></a>
<a id="__codelineno-36-13" name="__codelineno-36-13" href="#__codelineno-36-13"></a><span class="c"># (common end)</span>
<a id="__codelineno-36-14" name="__codelineno-36-14" href="#__codelineno-36-14"></a>
<a id="__codelineno-36-15" name="__codelineno-36-15" href="#__codelineno-36-15"></a>
<a id="__codelineno-36-16" name="__codelineno-36-16" href="#__codelineno-36-16"></a><span class="c"># gets only the file name</span>
<a id="__codelineno-36-17" name="__codelineno-36-17" href="#__codelineno-36-17"></a><span class="nv">$media_name</span> <span class="p">=</span> <span class="s1">'$input'</span> <span class="p">|</span> <span class="nb">Split-Path</span> <span class="n">-leaf</span><span class="p">;</span>
<a id="__codelineno-36-18" name="__codelineno-36-18" href="#__codelineno-36-18"></a>
<a id="__codelineno-36-19" name="__codelineno-36-19" href="#__codelineno-36-19"></a><span class="nv">$added_notes</span> <span class="p">=</span> <span class="n">Run-Json</span> <span class="p">@{</span>
<a id="__codelineno-36-20" name="__codelineno-36-20" href="#__codelineno-36-20"></a>    <span class="n">action</span> <span class="p">=</span> <span class="s1">'findNotes'</span><span class="p">;</span>
<a id="__codelineno-36-21" name="__codelineno-36-21" href="#__codelineno-36-21"></a>    <span class="n">version</span> <span class="p">=</span> <span class="n">6</span><span class="p">;</span>
<a id="__codelineno-36-22" name="__codelineno-36-22" href="#__codelineno-36-22"></a>    <span class="n">params</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-36-23" name="__codelineno-36-23" href="#__codelineno-36-23"></a>        <span class="n">query</span> <span class="p">=</span> <span class="s1">'added:1'</span><span class="p">;</span>
<a id="__codelineno-36-24" name="__codelineno-36-24" href="#__codelineno-36-24"></a>    <span class="p">}</span>
<a id="__codelineno-36-25" name="__codelineno-36-25" href="#__codelineno-36-25"></a><span class="p">};</span>
<a id="__codelineno-36-26" name="__codelineno-36-26" href="#__codelineno-36-26"></a>
<a id="__codelineno-36-27" name="__codelineno-36-27" href="#__codelineno-36-27"></a><span class="nv">$sorted_list</span> <span class="p">=</span> <span class="nv">$added_notes</span><span class="p">.</span><span class="n">result</span> <span class="p">|</span> <span class="nb">Sort-Object</span> <span class="n">-Descending</span> <span class="p">{</span><span class="no">[Long]</span><span class="nv">$_</span><span class="p">};</span>
<a id="__codelineno-36-28" name="__codelineno-36-28" href="#__codelineno-36-28"></a>
<a id="__codelineno-36-29" name="__codelineno-36-29" href="#__codelineno-36-29"></a><span class="nv">$curr_note_id</span> <span class="p">=</span> <span class="nv">$sorted_list</span><span class="p">[</span><span class="n">0</span><span class="p">];</span>
<a id="__codelineno-36-30" name="__codelineno-36-30" href="#__codelineno-36-30"></a>
<a id="__codelineno-36-31" name="__codelineno-36-31" href="#__codelineno-36-31"></a>
<a id="__codelineno-36-32" name="__codelineno-36-32" href="#__codelineno-36-32"></a><span class="n">Run-Json</span> <span class="p">@{</span>
<a id="__codelineno-36-33" name="__codelineno-36-33" href="#__codelineno-36-33"></a>    <span class="n">action</span> <span class="p">=</span> <span class="s1">'updateNoteFields'</span><span class="p">;</span>
<a id="__codelineno-36-34" name="__codelineno-36-34" href="#__codelineno-36-34"></a>    <span class="n">version</span> <span class="p">=</span> <span class="n">6</span><span class="p">;</span>
<a id="__codelineno-36-35" name="__codelineno-36-35" href="#__codelineno-36-35"></a>    <span class="n">params</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-36-36" name="__codelineno-36-36" href="#__codelineno-36-36"></a>        <span class="n">note</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-36-37" name="__codelineno-36-37" href="#__codelineno-36-37"></a>            <span class="n">id</span> <span class="p">=</span> <span class="nv">$curr_note_id</span><span class="p">;</span>
<a id="__codelineno-36-38" name="__codelineno-36-38" href="#__codelineno-36-38"></a>            <span class="n">fields</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-36-39" name="__codelineno-36-39" href="#__codelineno-36-39"></a>                <span class="n">SentenceAudio</span> <span class="p">=</span> <span class="s2">"[sound:$media_name]"</span><span class="p">;</span>
<a id="__codelineno-36-40" name="__codelineno-36-40" href="#__codelineno-36-40"></a>            <span class="p">}</span>
<a id="__codelineno-36-41" name="__codelineno-36-41" href="#__codelineno-36-41"></a>        <span class="p">}</span>
<a id="__codelineno-36-42" name="__codelineno-36-42" href="#__codelineno-36-42"></a>    <span class="p">}</span>
<a id="__codelineno-36-43" name="__codelineno-36-43" href="#__codelineno-36-43"></a><span class="p">};</span>
</code></pre></div>
</details>
</details>
<details class="info">
<summary>Update Sentence with Clipboard</summary>
<div class="admonition example">
<p class="admonition-title">ShareX Script</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>-NoProfile -Command "function Run-Json { param( $json_map ); $json = $json_map | ConvertTo-Json -Depth 5; $data = Invoke-RestMethod -Uri http://127.0.0.1:8765 -Method Post -ContentType 'application/json; charset=UTF-8' -Body $json; return $data; }; $clipboard = (Get-Clipboard | where{$_ -ne ''}) -join ''; $added_notes = Run-Json @{ action = 'findNotes'; version = 6; params = @{ query = 'added:1'; } }; $sorted_list = $added_notes.result | Sort-Object -Descending {[Long]$_}; $curr_note_id = $sorted_list[0]; $curr_note_data = Run-Json @{ action = 'notesInfo'; version = 6; params = @{ notes = @($curr_note_id); } }; $curr_note_sent = $curr_note_data.result.fields.Sentence.value; $result_sent = ''; if ($curr_note_sent -match '&lt;b&gt;(?&lt;bolded&gt;.+)&lt;/b&gt;') { $bolded = $matches['bolded']; $result_sent = $clipboard.replace($bolded, \"&lt;b&gt;$bolded&lt;/b&gt;\"); } else { $result_sent = $clipboard; }; Run-Json @{ action = 'updateNoteFields'; version = 6; params = @{ note = @{ id = $curr_note_id; fields = @{ Sentence = $result_sent; SentenceReading = ''; } } } };"
</code></pre></div>
</div>
<details class="example">
<summary>Original ShareX Code <small>(click here)</small></summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="c"># (common begin)</span>
<a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a>
<a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a><span class="k">function</span> <span class="n">Run-Json</span> <span class="p">{</span>
<a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a>    <span class="k">param</span><span class="p">(</span> <span class="nv">$json_map</span> <span class="p">);</span>
<a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a>
<a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a>    <span class="nv">$json</span> <span class="p">=</span> <span class="nv">$json_map</span> <span class="p">|</span> <span class="nb">ConvertTo-Json</span> <span class="n">-Depth</span> <span class="n">5</span><span class="p">;</span>
<a id="__codelineno-38-7" name="__codelineno-38-7" href="#__codelineno-38-7"></a>    <span class="nv">$data</span> <span class="p">=</span> <span class="nb">Invoke-RestMethod</span> <span class="n">-Uri</span> <span class="n">http</span><span class="p">://</span><span class="n">127</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">1</span><span class="p">:</span><span class="n">8765</span> <span class="n">-Method</span> <span class="n">Post</span> <span class="n">-ContentType</span> <span class="p">`</span>
<a id="__codelineno-38-8" name="__codelineno-38-8" href="#__codelineno-38-8"></a>        <span class="s1">'application/json; charset=UTF-8'</span> <span class="n">-Body</span> <span class="nv">$json</span><span class="p">;</span>
<a id="__codelineno-38-9" name="__codelineno-38-9" href="#__codelineno-38-9"></a>
<a id="__codelineno-38-10" name="__codelineno-38-10" href="#__codelineno-38-10"></a>    <span class="k">return</span> <span class="nv">$data</span><span class="p">;</span>
<a id="__codelineno-38-11" name="__codelineno-38-11" href="#__codelineno-38-11"></a><span class="p">};</span>
<a id="__codelineno-38-12" name="__codelineno-38-12" href="#__codelineno-38-12"></a>
<a id="__codelineno-38-13" name="__codelineno-38-13" href="#__codelineno-38-13"></a><span class="c"># (common end)</span>
<a id="__codelineno-38-14" name="__codelineno-38-14" href="#__codelineno-38-14"></a>
<a id="__codelineno-38-15" name="__codelineno-38-15" href="#__codelineno-38-15"></a>
<a id="__codelineno-38-16" name="__codelineno-38-16" href="#__codelineno-38-16"></a>
<a id="__codelineno-38-17" name="__codelineno-38-17" href="#__codelineno-38-17"></a><span class="nv">$clipboard</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Get-Clipboard</span> <span class="p">|</span> <span class="n">where</span><span class="p">{</span><span class="nv">$_</span> <span class="o">-ne</span> <span class="s1">''</span><span class="p">})</span> <span class="n">-join</span> <span class="s1">''</span><span class="p">;</span>
<a id="__codelineno-38-18" name="__codelineno-38-18" href="#__codelineno-38-18"></a>
<a id="__codelineno-38-19" name="__codelineno-38-19" href="#__codelineno-38-19"></a><span class="nv">$added_notes</span> <span class="p">=</span> <span class="n">Run-Json</span> <span class="p">@{</span>
<a id="__codelineno-38-20" name="__codelineno-38-20" href="#__codelineno-38-20"></a>    <span class="n">action</span> <span class="p">=</span> <span class="s1">'findNotes'</span><span class="p">;</span>
<a id="__codelineno-38-21" name="__codelineno-38-21" href="#__codelineno-38-21"></a>    <span class="n">version</span> <span class="p">=</span> <span class="n">6</span><span class="p">;</span>
<a id="__codelineno-38-22" name="__codelineno-38-22" href="#__codelineno-38-22"></a>    <span class="n">params</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-38-23" name="__codelineno-38-23" href="#__codelineno-38-23"></a>        <span class="n">query</span> <span class="p">=</span> <span class="s1">'added:1'</span><span class="p">;</span>
<a id="__codelineno-38-24" name="__codelineno-38-24" href="#__codelineno-38-24"></a>    <span class="p">}</span>
<a id="__codelineno-38-25" name="__codelineno-38-25" href="#__codelineno-38-25"></a><span class="p">};</span>
<a id="__codelineno-38-26" name="__codelineno-38-26" href="#__codelineno-38-26"></a>
<a id="__codelineno-38-27" name="__codelineno-38-27" href="#__codelineno-38-27"></a><span class="nv">$sorted_list</span> <span class="p">=</span> <span class="nv">$added_notes</span><span class="p">.</span><span class="n">result</span> <span class="p">|</span> <span class="nb">Sort-Object</span> <span class="n">-Descending</span> <span class="p">{</span><span class="no">[Long]</span><span class="nv">$_</span><span class="p">};</span>
<a id="__codelineno-38-28" name="__codelineno-38-28" href="#__codelineno-38-28"></a>
<a id="__codelineno-38-29" name="__codelineno-38-29" href="#__codelineno-38-29"></a><span class="nv">$curr_note_id</span> <span class="p">=</span> <span class="nv">$sorted_list</span><span class="p">[</span><span class="n">0</span><span class="p">];</span>
<a id="__codelineno-38-30" name="__codelineno-38-30" href="#__codelineno-38-30"></a>
<a id="__codelineno-38-31" name="__codelineno-38-31" href="#__codelineno-38-31"></a><span class="nv">$curr_note_data</span> <span class="p">=</span> <span class="n">Run-Json</span> <span class="p">@{</span>
<a id="__codelineno-38-32" name="__codelineno-38-32" href="#__codelineno-38-32"></a>    <span class="n">action</span> <span class="p">=</span> <span class="s1">'notesInfo'</span><span class="p">;</span>
<a id="__codelineno-38-33" name="__codelineno-38-33" href="#__codelineno-38-33"></a>    <span class="n">version</span> <span class="p">=</span> <span class="n">6</span><span class="p">;</span>
<a id="__codelineno-38-34" name="__codelineno-38-34" href="#__codelineno-38-34"></a>    <span class="n">params</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-38-35" name="__codelineno-38-35" href="#__codelineno-38-35"></a>        <span class="n">notes</span> <span class="p">=</span> <span class="p">@(</span><span class="nv">$curr_note_id</span><span class="p">);</span>
<a id="__codelineno-38-36" name="__codelineno-38-36" href="#__codelineno-38-36"></a>    <span class="p">}</span>
<a id="__codelineno-38-37" name="__codelineno-38-37" href="#__codelineno-38-37"></a><span class="p">};</span>
<a id="__codelineno-38-38" name="__codelineno-38-38" href="#__codelineno-38-38"></a>
<a id="__codelineno-38-39" name="__codelineno-38-39" href="#__codelineno-38-39"></a><span class="nv">$curr_note_sent</span> <span class="p">=</span> <span class="nv">$curr_note_data</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">fields</span><span class="p">.</span><span class="n">Sentence</span><span class="p">.</span><span class="n">value</span><span class="p">;</span>
<a id="__codelineno-38-40" name="__codelineno-38-40" href="#__codelineno-38-40"></a><span class="nv">$result_sent</span> <span class="p">=</span> <span class="s1">''</span><span class="p">;</span>
<a id="__codelineno-38-41" name="__codelineno-38-41" href="#__codelineno-38-41"></a>
<a id="__codelineno-38-42" name="__codelineno-38-42" href="#__codelineno-38-42"></a><span class="k">if</span> <span class="p">(</span><span class="nv">$curr_note_sent</span> <span class="o">-match</span> <span class="s1">'&lt;b&gt;(?&lt;bolded&gt;.+)&lt;/b&gt;'</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-38-43" name="__codelineno-38-43" href="#__codelineno-38-43"></a>    <span class="nv">$bolded</span> <span class="p">=</span> <span class="nv">$matches</span><span class="p">[</span><span class="s1">'bolded'</span><span class="p">];</span>
<a id="__codelineno-38-44" name="__codelineno-38-44" href="#__codelineno-38-44"></a>    <span class="c"># may not replace anything</span>
<a id="__codelineno-38-45" name="__codelineno-38-45" href="#__codelineno-38-45"></a>    <span class="nv">$result_sent</span> <span class="p">=</span> <span class="nv">$clipboard</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="nv">$bolded</span><span class="p">,</span> <span class="s2">"&lt;b&gt;$bolded&lt;/b&gt;"</span><span class="p">);</span>
<a id="__codelineno-38-46" name="__codelineno-38-46" href="#__codelineno-38-46"></a><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<a id="__codelineno-38-47" name="__codelineno-38-47" href="#__codelineno-38-47"></a>    <span class="c"># default</span>
<a id="__codelineno-38-48" name="__codelineno-38-48" href="#__codelineno-38-48"></a>    <span class="nv">$result_sent</span> <span class="p">=</span> <span class="nv">$clipboard</span><span class="p">;</span>
<a id="__codelineno-38-49" name="__codelineno-38-49" href="#__codelineno-38-49"></a><span class="p">};</span>
<a id="__codelineno-38-50" name="__codelineno-38-50" href="#__codelineno-38-50"></a>
<a id="__codelineno-38-51" name="__codelineno-38-51" href="#__codelineno-38-51"></a>
<a id="__codelineno-38-52" name="__codelineno-38-52" href="#__codelineno-38-52"></a><span class="c"># updates current card with result_sent</span>
<a id="__codelineno-38-53" name="__codelineno-38-53" href="#__codelineno-38-53"></a><span class="n">Run-Json</span> <span class="p">@{</span>
<a id="__codelineno-38-54" name="__codelineno-38-54" href="#__codelineno-38-54"></a>    <span class="n">action</span> <span class="p">=</span> <span class="s1">'updateNoteFields'</span><span class="p">;</span>
<a id="__codelineno-38-55" name="__codelineno-38-55" href="#__codelineno-38-55"></a>    <span class="n">version</span> <span class="p">=</span> <span class="n">6</span><span class="p">;</span>
<a id="__codelineno-38-56" name="__codelineno-38-56" href="#__codelineno-38-56"></a>    <span class="n">params</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-38-57" name="__codelineno-38-57" href="#__codelineno-38-57"></a>        <span class="n">note</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-38-58" name="__codelineno-38-58" href="#__codelineno-38-58"></a>            <span class="n">id</span> <span class="p">=</span> <span class="nv">$curr_note_id</span><span class="p">;</span>
<a id="__codelineno-38-59" name="__codelineno-38-59" href="#__codelineno-38-59"></a>            <span class="n">fields</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-38-60" name="__codelineno-38-60" href="#__codelineno-38-60"></a>                <span class="n">Sentence</span> <span class="p">=</span> <span class="nv">$result_sent</span><span class="p">;</span>
<a id="__codelineno-38-61" name="__codelineno-38-61" href="#__codelineno-38-61"></a>                <span class="n">SentenceReading</span> <span class="p">=</span> <span class="s1">''</span><span class="p">;</span>
<a id="__codelineno-38-62" name="__codelineno-38-62" href="#__codelineno-38-62"></a>            <span class="p">}</span>
<a id="__codelineno-38-63" name="__codelineno-38-63" href="#__codelineno-38-63"></a>        <span class="p">}</span>
<a id="__codelineno-38-64" name="__codelineno-38-64" href="#__codelineno-38-64"></a>    <span class="p">}</span>
<a id="__codelineno-38-65" name="__codelineno-38-65" href="#__codelineno-38-65"></a><span class="p">};</span>
</code></pre></div>
</details>
</details>
<details class="info">
<summary>Update AdditionalNotes with Clipboard</summary>
<div class="admonition example">
<p class="admonition-title">ShareX Script</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>-NoProfile -Command "function Run-Json { param( $json_map ); $json = $json_map | ConvertTo-Json -Depth 5; $data = Invoke-RestMethod -Uri http://127.0.0.1:8765 -Method Post -ContentType 'application/json; charset=UTF-8' -Body $json; return $data; }; $clipboard = (Get-Clipboard | where{$_ -ne \"\"}) -join \"&lt;br&gt;\"; $added_notes = Run-Json @{ action = 'findNotes'; version = 6; params = @{ query = 'added:1'; } }; $sorted_list = $added_notes.result | Sort-Object -Descending {[Long]$_}; $curr_note_id = $sorted_list[0]; $curr_note_data = Run-Json @{ action = 'notesInfo'; version = 6; params = @{ notes = @($curr_note_id); } }; $curr_note_sent = $curr_note_data.result.fields.Sentence.value; $result_sent = ''; if ($curr_note_sent -match '&lt;b&gt;(?&lt;bolded&gt;.+)&lt;/b&gt;') { $bolded = $matches['bolded']; $result_sent = $clipboard.replace($bolded, \"&lt;b&gt;$bolded&lt;/b&gt;\"); } else { $result_sent = $clipboard; }; Run-Json @{ action = 'updateNoteFields'; version = 6; params = @{ note = @{ id = $curr_note_id; fields = @{ AdditionalNotes = $result_sent; } } } };"
</code></pre></div>
</div>
<details class="example">
<summary>Original ShareX Code <small>(click here)</small></summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="c"># (common begin)</span>
<a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a>
<a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a><span class="k">function</span> <span class="n">Run-Json</span> <span class="p">{</span>
<a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a>    <span class="k">param</span><span class="p">(</span> <span class="nv">$json_map</span> <span class="p">);</span>
<a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a>
<a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a>    <span class="nv">$json</span> <span class="p">=</span> <span class="nv">$json_map</span> <span class="p">|</span> <span class="nb">ConvertTo-Json</span> <span class="n">-Depth</span> <span class="n">5</span><span class="p">;</span>
<a id="__codelineno-40-7" name="__codelineno-40-7" href="#__codelineno-40-7"></a>    <span class="nv">$data</span> <span class="p">=</span> <span class="nb">Invoke-RestMethod</span> <span class="n">-Uri</span> <span class="n">http</span><span class="p">://</span><span class="n">127</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">1</span><span class="p">:</span><span class="n">8765</span> <span class="n">-Method</span> <span class="n">Post</span> <span class="n">-ContentType</span> <span class="p">`</span>
<a id="__codelineno-40-8" name="__codelineno-40-8" href="#__codelineno-40-8"></a>        <span class="s1">'application/json; charset=UTF-8'</span> <span class="n">-Body</span> <span class="nv">$json</span><span class="p">;</span>
<a id="__codelineno-40-9" name="__codelineno-40-9" href="#__codelineno-40-9"></a>
<a id="__codelineno-40-10" name="__codelineno-40-10" href="#__codelineno-40-10"></a>    <span class="k">return</span> <span class="nv">$data</span><span class="p">;</span>
<a id="__codelineno-40-11" name="__codelineno-40-11" href="#__codelineno-40-11"></a><span class="p">};</span>
<a id="__codelineno-40-12" name="__codelineno-40-12" href="#__codelineno-40-12"></a>
<a id="__codelineno-40-13" name="__codelineno-40-13" href="#__codelineno-40-13"></a><span class="c"># (common end)</span>
<a id="__codelineno-40-14" name="__codelineno-40-14" href="#__codelineno-40-14"></a>
<a id="__codelineno-40-15" name="__codelineno-40-15" href="#__codelineno-40-15"></a>
<a id="__codelineno-40-16" name="__codelineno-40-16" href="#__codelineno-40-16"></a>
<a id="__codelineno-40-17" name="__codelineno-40-17" href="#__codelineno-40-17"></a><span class="nv">$clipboard</span> <span class="p">=</span> <span class="p">(</span><span class="nb">Get-Clipboard</span> <span class="p">|</span> <span class="n">where</span><span class="p">{</span><span class="nv">$_</span> <span class="o">-ne</span> <span class="s2">""</span><span class="p">})</span> <span class="n">-join</span> <span class="s2">"&lt;br&gt;"</span><span class="p">;</span>
<a id="__codelineno-40-18" name="__codelineno-40-18" href="#__codelineno-40-18"></a>
<a id="__codelineno-40-19" name="__codelineno-40-19" href="#__codelineno-40-19"></a><span class="nv">$added_notes</span> <span class="p">=</span> <span class="n">Run-Json</span> <span class="p">@{</span>
<a id="__codelineno-40-20" name="__codelineno-40-20" href="#__codelineno-40-20"></a>    <span class="n">action</span> <span class="p">=</span> <span class="s1">'findNotes'</span><span class="p">;</span>
<a id="__codelineno-40-21" name="__codelineno-40-21" href="#__codelineno-40-21"></a>    <span class="n">version</span> <span class="p">=</span> <span class="n">6</span><span class="p">;</span>
<a id="__codelineno-40-22" name="__codelineno-40-22" href="#__codelineno-40-22"></a>    <span class="n">params</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-40-23" name="__codelineno-40-23" href="#__codelineno-40-23"></a>        <span class="n">query</span> <span class="p">=</span> <span class="s1">'added:1'</span><span class="p">;</span>
<a id="__codelineno-40-24" name="__codelineno-40-24" href="#__codelineno-40-24"></a>    <span class="p">}</span>
<a id="__codelineno-40-25" name="__codelineno-40-25" href="#__codelineno-40-25"></a><span class="p">};</span>
<a id="__codelineno-40-26" name="__codelineno-40-26" href="#__codelineno-40-26"></a>
<a id="__codelineno-40-27" name="__codelineno-40-27" href="#__codelineno-40-27"></a><span class="nv">$sorted_list</span> <span class="p">=</span> <span class="nv">$added_notes</span><span class="p">.</span><span class="n">result</span> <span class="p">|</span> <span class="nb">Sort-Object</span> <span class="n">-Descending</span> <span class="p">{</span><span class="no">[Long]</span><span class="nv">$_</span><span class="p">};</span>
<a id="__codelineno-40-28" name="__codelineno-40-28" href="#__codelineno-40-28"></a>
<a id="__codelineno-40-29" name="__codelineno-40-29" href="#__codelineno-40-29"></a><span class="nv">$curr_note_id</span> <span class="p">=</span> <span class="nv">$sorted_list</span><span class="p">[</span><span class="n">0</span><span class="p">];</span>
<a id="__codelineno-40-30" name="__codelineno-40-30" href="#__codelineno-40-30"></a>
<a id="__codelineno-40-31" name="__codelineno-40-31" href="#__codelineno-40-31"></a><span class="nv">$curr_note_data</span> <span class="p">=</span> <span class="n">Run-Json</span> <span class="p">@{</span>
<a id="__codelineno-40-32" name="__codelineno-40-32" href="#__codelineno-40-32"></a>    <span class="n">action</span> <span class="p">=</span> <span class="s1">'notesInfo'</span><span class="p">;</span>
<a id="__codelineno-40-33" name="__codelineno-40-33" href="#__codelineno-40-33"></a>    <span class="n">version</span> <span class="p">=</span> <span class="n">6</span><span class="p">;</span>
<a id="__codelineno-40-34" name="__codelineno-40-34" href="#__codelineno-40-34"></a>    <span class="n">params</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-40-35" name="__codelineno-40-35" href="#__codelineno-40-35"></a>        <span class="n">notes</span> <span class="p">=</span> <span class="p">@(</span><span class="nv">$curr_note_id</span><span class="p">);</span>
<a id="__codelineno-40-36" name="__codelineno-40-36" href="#__codelineno-40-36"></a>    <span class="p">}</span>
<a id="__codelineno-40-37" name="__codelineno-40-37" href="#__codelineno-40-37"></a><span class="p">};</span>
<a id="__codelineno-40-38" name="__codelineno-40-38" href="#__codelineno-40-38"></a>
<a id="__codelineno-40-39" name="__codelineno-40-39" href="#__codelineno-40-39"></a><span class="nv">$curr_note_sent</span> <span class="p">=</span> <span class="nv">$curr_note_data</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">fields</span><span class="p">.</span><span class="n">Sentence</span><span class="p">.</span><span class="n">value</span><span class="p">;</span>
<a id="__codelineno-40-40" name="__codelineno-40-40" href="#__codelineno-40-40"></a><span class="nv">$result_sent</span> <span class="p">=</span> <span class="s1">''</span><span class="p">;</span>
<a id="__codelineno-40-41" name="__codelineno-40-41" href="#__codelineno-40-41"></a>
<a id="__codelineno-40-42" name="__codelineno-40-42" href="#__codelineno-40-42"></a><span class="k">if</span> <span class="p">(</span><span class="nv">$curr_note_sent</span> <span class="o">-match</span> <span class="s1">'&lt;b&gt;(?&lt;bolded&gt;.+)&lt;/b&gt;'</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-40-43" name="__codelineno-40-43" href="#__codelineno-40-43"></a>    <span class="nv">$bolded</span> <span class="p">=</span> <span class="nv">$matches</span><span class="p">[</span><span class="s1">'bolded'</span><span class="p">];</span>
<a id="__codelineno-40-44" name="__codelineno-40-44" href="#__codelineno-40-44"></a>    <span class="c"># may not replace anything</span>
<a id="__codelineno-40-45" name="__codelineno-40-45" href="#__codelineno-40-45"></a>    <span class="nv">$result_sent</span> <span class="p">=</span> <span class="nv">$clipboard</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="nv">$bolded</span><span class="p">,</span> <span class="s2">"&lt;b&gt;$bolded&lt;/b&gt;"</span><span class="p">);</span>
<a id="__codelineno-40-46" name="__codelineno-40-46" href="#__codelineno-40-46"></a><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
<a id="__codelineno-40-47" name="__codelineno-40-47" href="#__codelineno-40-47"></a>    <span class="c"># default</span>
<a id="__codelineno-40-48" name="__codelineno-40-48" href="#__codelineno-40-48"></a>    <span class="nv">$result_sent</span> <span class="p">=</span> <span class="nv">$clipboard</span><span class="p">;</span>
<a id="__codelineno-40-49" name="__codelineno-40-49" href="#__codelineno-40-49"></a><span class="p">};</span>
<a id="__codelineno-40-50" name="__codelineno-40-50" href="#__codelineno-40-50"></a>
<a id="__codelineno-40-51" name="__codelineno-40-51" href="#__codelineno-40-51"></a>
<a id="__codelineno-40-52" name="__codelineno-40-52" href="#__codelineno-40-52"></a><span class="c"># updates current card with result_sent</span>
<a id="__codelineno-40-53" name="__codelineno-40-53" href="#__codelineno-40-53"></a><span class="n">Run-Json</span> <span class="p">@{</span>
<a id="__codelineno-40-54" name="__codelineno-40-54" href="#__codelineno-40-54"></a>    <span class="n">action</span> <span class="p">=</span> <span class="s1">'updateNoteFields'</span><span class="p">;</span>
<a id="__codelineno-40-55" name="__codelineno-40-55" href="#__codelineno-40-55"></a>    <span class="n">version</span> <span class="p">=</span> <span class="n">6</span><span class="p">;</span>
<a id="__codelineno-40-56" name="__codelineno-40-56" href="#__codelineno-40-56"></a>    <span class="n">params</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-40-57" name="__codelineno-40-57" href="#__codelineno-40-57"></a>        <span class="n">note</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-40-58" name="__codelineno-40-58" href="#__codelineno-40-58"></a>            <span class="n">id</span> <span class="p">=</span> <span class="nv">$curr_note_id</span><span class="p">;</span>
<a id="__codelineno-40-59" name="__codelineno-40-59" href="#__codelineno-40-59"></a>            <span class="n">fields</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-40-60" name="__codelineno-40-60" href="#__codelineno-40-60"></a>                <span class="n">AdditionalNotes</span> <span class="p">=</span> <span class="nv">$result_sent</span><span class="p">;</span>
<a id="__codelineno-40-61" name="__codelineno-40-61" href="#__codelineno-40-61"></a>            <span class="p">}</span>
<a id="__codelineno-40-62" name="__codelineno-40-62" href="#__codelineno-40-62"></a>        <span class="p">}</span>
<a id="__codelineno-40-63" name="__codelineno-40-63" href="#__codelineno-40-63"></a>    <span class="p">}</span>
<a id="__codelineno-40-64" name="__codelineno-40-64" href="#__codelineno-40-64"></a><span class="p">};</span>
</code></pre></div>
</details>
</details>
<details class="info">
<summary>Copy from Previous Card</summary>
<div class="admonition example">
<p class="admonition-title">ShareX Script</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a>-NoProfile -Command "function Run-Json { param( $json_map ); $json = $json_map | ConvertTo-Json -Depth 5; $data = Invoke-RestMethod -Uri http://127.0.0.1:8765 -Method Post -ContentType 'application/json; charset=UTF-8' -Body $json; return $data; }; $added_notes = Run-Json @{ action = 'findNotes'; version = 6; params = @{ query = 'added:1'; } }; $sorted_list = $added_notes.result | Sort-Object -Descending {[Long]$_}; $prev_note_id = $sorted_list[1]; $curr_note_id = $sorted_list[0]; $prev_note_data = Run-Json @{ action = 'notesInfo'; version = 6; params = @{ notes = @($prev_note_id); } }; Run-Json @{ action = 'updateNoteFields'; version = 6; params = @{ note = @{ id = $curr_note_id; fields = @{ Picture = $prev_note_data.result.fields.Picture.value; AdditionalNotes = $prev_note_data.result.fields.AdditionalNotes.value; } } } }; foreach ($tag in $prev_note_data.result.tags) { Run-Json @{ action = 'addTags'; version = 6; params = @{ notes = @($curr_note_id); tags = $tag; } } };"
</code></pre></div>
</div>
<details class="example">
<summary>Original ShareX Code <small>(click here)</small></summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="c"># (common begin)</span>
<a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a>
<a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a><span class="k">function</span> <span class="n">Run-Json</span> <span class="p">{</span>
<a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a>    <span class="k">param</span><span class="p">(</span> <span class="nv">$json_map</span> <span class="p">);</span>
<a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a>
<a id="__codelineno-42-6" name="__codelineno-42-6" href="#__codelineno-42-6"></a>    <span class="nv">$json</span> <span class="p">=</span> <span class="nv">$json_map</span> <span class="p">|</span> <span class="nb">ConvertTo-Json</span> <span class="n">-Depth</span> <span class="n">5</span><span class="p">;</span>
<a id="__codelineno-42-7" name="__codelineno-42-7" href="#__codelineno-42-7"></a>    <span class="nv">$data</span> <span class="p">=</span> <span class="nb">Invoke-RestMethod</span> <span class="n">-Uri</span> <span class="n">http</span><span class="p">://</span><span class="n">127</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">1</span><span class="p">:</span><span class="n">8765</span> <span class="n">-Method</span> <span class="n">Post</span> <span class="n">-ContentType</span> <span class="p">`</span>
<a id="__codelineno-42-8" name="__codelineno-42-8" href="#__codelineno-42-8"></a>        <span class="s1">'application/json; charset=UTF-8'</span> <span class="n">-Body</span> <span class="nv">$json</span><span class="p">;</span>
<a id="__codelineno-42-9" name="__codelineno-42-9" href="#__codelineno-42-9"></a>
<a id="__codelineno-42-10" name="__codelineno-42-10" href="#__codelineno-42-10"></a>    <span class="k">return</span> <span class="nv">$data</span><span class="p">;</span>
<a id="__codelineno-42-11" name="__codelineno-42-11" href="#__codelineno-42-11"></a><span class="p">};</span>
<a id="__codelineno-42-12" name="__codelineno-42-12" href="#__codelineno-42-12"></a>
<a id="__codelineno-42-13" name="__codelineno-42-13" href="#__codelineno-42-13"></a><span class="c"># (common end)</span>
<a id="__codelineno-42-14" name="__codelineno-42-14" href="#__codelineno-42-14"></a>
<a id="__codelineno-42-15" name="__codelineno-42-15" href="#__codelineno-42-15"></a>
<a id="__codelineno-42-16" name="__codelineno-42-16" href="#__codelineno-42-16"></a>
<a id="__codelineno-42-17" name="__codelineno-42-17" href="#__codelineno-42-17"></a><span class="nv">$added_notes</span> <span class="p">=</span> <span class="n">Run-Json</span> <span class="p">@{</span>
<a id="__codelineno-42-18" name="__codelineno-42-18" href="#__codelineno-42-18"></a>    <span class="n">action</span> <span class="p">=</span> <span class="s1">'findNotes'</span><span class="p">;</span>
<a id="__codelineno-42-19" name="__codelineno-42-19" href="#__codelineno-42-19"></a>    <span class="n">version</span> <span class="p">=</span> <span class="n">6</span><span class="p">;</span>
<a id="__codelineno-42-20" name="__codelineno-42-20" href="#__codelineno-42-20"></a>    <span class="n">params</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-42-21" name="__codelineno-42-21" href="#__codelineno-42-21"></a>        <span class="n">query</span> <span class="p">=</span> <span class="s1">'added:1'</span><span class="p">;</span>
<a id="__codelineno-42-22" name="__codelineno-42-22" href="#__codelineno-42-22"></a>    <span class="p">}</span>
<a id="__codelineno-42-23" name="__codelineno-42-23" href="#__codelineno-42-23"></a><span class="p">};</span>
<a id="__codelineno-42-24" name="__codelineno-42-24" href="#__codelineno-42-24"></a>
<a id="__codelineno-42-25" name="__codelineno-42-25" href="#__codelineno-42-25"></a><span class="nv">$sorted_list</span> <span class="p">=</span> <span class="nv">$added_notes</span><span class="p">.</span><span class="n">result</span> <span class="p">|</span> <span class="nb">Sort-Object</span> <span class="n">-Descending</span> <span class="p">{</span><span class="no">[Long]</span><span class="nv">$_</span><span class="p">};</span>
<a id="__codelineno-42-26" name="__codelineno-42-26" href="#__codelineno-42-26"></a>
<a id="__codelineno-42-27" name="__codelineno-42-27" href="#__codelineno-42-27"></a><span class="nv">$prev_note_id</span> <span class="p">=</span> <span class="nv">$sorted_list</span><span class="p">[</span><span class="n">1</span><span class="p">];</span>
<a id="__codelineno-42-28" name="__codelineno-42-28" href="#__codelineno-42-28"></a><span class="nv">$curr_note_id</span> <span class="p">=</span> <span class="nv">$sorted_list</span><span class="p">[</span><span class="n">0</span><span class="p">];</span>
<a id="__codelineno-42-29" name="__codelineno-42-29" href="#__codelineno-42-29"></a>
<a id="__codelineno-42-30" name="__codelineno-42-30" href="#__codelineno-42-30"></a>
<a id="__codelineno-42-31" name="__codelineno-42-31" href="#__codelineno-42-31"></a><span class="nv">$prev_note_data</span> <span class="p">=</span> <span class="n">Run-Json</span> <span class="p">@{</span>
<a id="__codelineno-42-32" name="__codelineno-42-32" href="#__codelineno-42-32"></a>    <span class="n">action</span> <span class="p">=</span> <span class="s1">'notesInfo'</span><span class="p">;</span>
<a id="__codelineno-42-33" name="__codelineno-42-33" href="#__codelineno-42-33"></a>    <span class="n">version</span> <span class="p">=</span> <span class="n">6</span><span class="p">;</span>
<a id="__codelineno-42-34" name="__codelineno-42-34" href="#__codelineno-42-34"></a>    <span class="n">params</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-42-35" name="__codelineno-42-35" href="#__codelineno-42-35"></a>        <span class="n">notes</span> <span class="p">=</span> <span class="p">@(</span><span class="nv">$prev_note_id</span><span class="p">);</span>
<a id="__codelineno-42-36" name="__codelineno-42-36" href="#__codelineno-42-36"></a>    <span class="p">}</span>
<a id="__codelineno-42-37" name="__codelineno-42-37" href="#__codelineno-42-37"></a><span class="p">};</span>
<a id="__codelineno-42-38" name="__codelineno-42-38" href="#__codelineno-42-38"></a>
<a id="__codelineno-42-39" name="__codelineno-42-39" href="#__codelineno-42-39"></a><span class="c"># copies picture &amp; additional notes to current note</span>
<a id="__codelineno-42-40" name="__codelineno-42-40" href="#__codelineno-42-40"></a><span class="n">Run-Json</span> <span class="p">@{</span>
<a id="__codelineno-42-41" name="__codelineno-42-41" href="#__codelineno-42-41"></a>    <span class="n">action</span> <span class="p">=</span> <span class="s1">'updateNoteFields'</span><span class="p">;</span>
<a id="__codelineno-42-42" name="__codelineno-42-42" href="#__codelineno-42-42"></a>    <span class="n">version</span> <span class="p">=</span> <span class="n">6</span><span class="p">;</span>
<a id="__codelineno-42-43" name="__codelineno-42-43" href="#__codelineno-42-43"></a>    <span class="n">params</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-42-44" name="__codelineno-42-44" href="#__codelineno-42-44"></a>        <span class="n">note</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-42-45" name="__codelineno-42-45" href="#__codelineno-42-45"></a>            <span class="n">id</span> <span class="p">=</span> <span class="nv">$curr_note_id</span><span class="p">;</span>
<a id="__codelineno-42-46" name="__codelineno-42-46" href="#__codelineno-42-46"></a>            <span class="n">fields</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-42-47" name="__codelineno-42-47" href="#__codelineno-42-47"></a>                <span class="n">Picture</span> <span class="p">=</span> <span class="nv">$prev_note_data</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">fields</span><span class="p">.</span><span class="n">Picture</span><span class="p">.</span><span class="n">value</span><span class="p">;</span>
<a id="__codelineno-42-48" name="__codelineno-42-48" href="#__codelineno-42-48"></a>                <span class="n">AdditionalNotes</span> <span class="p">=</span> <span class="nv">$prev_note_data</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">fields</span><span class="p">.</span><span class="n">AdditionalNotes</span><span class="p">.</span><span class="n">value</span><span class="p">;</span>
<a id="__codelineno-42-49" name="__codelineno-42-49" href="#__codelineno-42-49"></a>            <span class="p">}</span>
<a id="__codelineno-42-50" name="__codelineno-42-50" href="#__codelineno-42-50"></a>        <span class="p">}</span>
<a id="__codelineno-42-51" name="__codelineno-42-51" href="#__codelineno-42-51"></a>    <span class="p">}</span>
<a id="__codelineno-42-52" name="__codelineno-42-52" href="#__codelineno-42-52"></a><span class="p">};</span>
<a id="__codelineno-42-53" name="__codelineno-42-53" href="#__codelineno-42-53"></a>
<a id="__codelineno-42-54" name="__codelineno-42-54" href="#__codelineno-42-54"></a><span class="c"># copies tags</span>
<a id="__codelineno-42-55" name="__codelineno-42-55" href="#__codelineno-42-55"></a><span class="k">foreach</span> <span class="p">(</span><span class="nv">$tag</span> <span class="k">in</span> <span class="nv">$prev_note_data</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">tags</span><span class="p">)</span> <span class="p">{</span>
<a id="__codelineno-42-56" name="__codelineno-42-56" href="#__codelineno-42-56"></a>    <span class="n">Run-Json</span> <span class="p">@{</span>
<a id="__codelineno-42-57" name="__codelineno-42-57" href="#__codelineno-42-57"></a>        <span class="n">action</span> <span class="p">=</span> <span class="s1">'addTags'</span><span class="p">;</span>
<a id="__codelineno-42-58" name="__codelineno-42-58" href="#__codelineno-42-58"></a>        <span class="n">version</span> <span class="p">=</span> <span class="n">6</span><span class="p">;</span>
<a id="__codelineno-42-59" name="__codelineno-42-59" href="#__codelineno-42-59"></a>        <span class="n">params</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-42-60" name="__codelineno-42-60" href="#__codelineno-42-60"></a>            <span class="n">notes</span> <span class="p">=</span> <span class="p">@(</span><span class="nv">$curr_note_id</span><span class="p">);</span>
<a id="__codelineno-42-61" name="__codelineno-42-61" href="#__codelineno-42-61"></a>            <span class="n">tags</span> <span class="p">=</span> <span class="nv">$tag</span><span class="p">;</span>
<a id="__codelineno-42-62" name="__codelineno-42-62" href="#__codelineno-42-62"></a>        <span class="p">}</span>
<a id="__codelineno-42-63" name="__codelineno-42-63" href="#__codelineno-42-63"></a>    <span class="p">}</span>
<a id="__codelineno-42-64" name="__codelineno-42-64" href="#__codelineno-42-64"></a><span class="p">};</span>
</code></pre></div>
</details>
</details>
<details class="info">
<summary>Orthographic Variants: Fix Sentence and Frequency</summary>
<div class="admonition example">
<p class="admonition-title">ShareX Script</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a>-NoProfile -Command "function Run-Json { param( $json_map ); $json = $json_map | ConvertTo-Json -Depth 5; $data = Invoke-RestMethod -Uri http://127.0.0.1:8765 -Method Post -ContentType 'application/json; charset=UTF-8' -Body $json; return $data; }; $added_notes = Run-Json @{ action = 'findNotes'; version = 6; params = @{ query = 'added:1'; } }; $sorted_list = $added_notes.result | Sort-Object -Descending {[Long]$_}; $prev_note_id = $sorted_list[1]; $curr_note_id = $sorted_list[0]; $curr_note_data = Run-Json @{ action = 'notesInfo'; version = 6; params = @{ notes = @($curr_note_id); } }; Run-Json @{ action = 'updateNoteFields'; version = 6; params = @{ note = @{ id = $prev_note_id; fields = @{ FrequenciesStylized = $curr_note_data.result.fields.FrequenciesStylized.value; Sentence = $curr_note_data.result.fields.Sentence.value; SentenceReading = $curr_note_data.result.fields.SentenceReading.value; } } } }; Run-Json @{ action = 'deleteNotes'; version = 6; params = @{ notes = @($curr_note_id); } };"
</code></pre></div>
</div>
<details class="example">
<summary>Original ShareX Code <small>(click here)</small></summary>
<div class="highlight"><pre><span></span><code><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="c"># (common begin)</span>
<a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a>
<a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a><span class="k">function</span> <span class="n">Run-Json</span> <span class="p">{</span>
<a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a>    <span class="k">param</span><span class="p">(</span> <span class="nv">$json_map</span> <span class="p">);</span>
<a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a>
<a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a>    <span class="nv">$json</span> <span class="p">=</span> <span class="nv">$json_map</span> <span class="p">|</span> <span class="nb">ConvertTo-Json</span> <span class="n">-Depth</span> <span class="n">5</span><span class="p">;</span>
<a id="__codelineno-44-7" name="__codelineno-44-7" href="#__codelineno-44-7"></a>    <span class="nv">$data</span> <span class="p">=</span> <span class="nb">Invoke-RestMethod</span> <span class="n">-Uri</span> <span class="n">http</span><span class="p">://</span><span class="n">127</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">1</span><span class="p">:</span><span class="n">8765</span> <span class="n">-Method</span> <span class="n">Post</span> <span class="n">-ContentType</span> <span class="p">`</span>
<a id="__codelineno-44-8" name="__codelineno-44-8" href="#__codelineno-44-8"></a>        <span class="s1">'application/json; charset=UTF-8'</span> <span class="n">-Body</span> <span class="nv">$json</span><span class="p">;</span>
<a id="__codelineno-44-9" name="__codelineno-44-9" href="#__codelineno-44-9"></a>
<a id="__codelineno-44-10" name="__codelineno-44-10" href="#__codelineno-44-10"></a>    <span class="k">return</span> <span class="nv">$data</span><span class="p">;</span>
<a id="__codelineno-44-11" name="__codelineno-44-11" href="#__codelineno-44-11"></a><span class="p">};</span>
<a id="__codelineno-44-12" name="__codelineno-44-12" href="#__codelineno-44-12"></a>
<a id="__codelineno-44-13" name="__codelineno-44-13" href="#__codelineno-44-13"></a><span class="c"># (common end)</span>
<a id="__codelineno-44-14" name="__codelineno-44-14" href="#__codelineno-44-14"></a>
<a id="__codelineno-44-15" name="__codelineno-44-15" href="#__codelineno-44-15"></a>
<a id="__codelineno-44-16" name="__codelineno-44-16" href="#__codelineno-44-16"></a><span class="nv">$added_notes</span> <span class="p">=</span> <span class="n">Run-Json</span> <span class="p">@{</span>
<a id="__codelineno-44-17" name="__codelineno-44-17" href="#__codelineno-44-17"></a>    <span class="n">action</span> <span class="p">=</span> <span class="s1">'findNotes'</span><span class="p">;</span>
<a id="__codelineno-44-18" name="__codelineno-44-18" href="#__codelineno-44-18"></a>    <span class="n">version</span> <span class="p">=</span> <span class="n">6</span><span class="p">;</span>
<a id="__codelineno-44-19" name="__codelineno-44-19" href="#__codelineno-44-19"></a>    <span class="n">params</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-44-20" name="__codelineno-44-20" href="#__codelineno-44-20"></a>        <span class="n">query</span> <span class="p">=</span> <span class="s1">'added:1'</span><span class="p">;</span>
<a id="__codelineno-44-21" name="__codelineno-44-21" href="#__codelineno-44-21"></a>    <span class="p">}</span>
<a id="__codelineno-44-22" name="__codelineno-44-22" href="#__codelineno-44-22"></a><span class="p">};</span>
<a id="__codelineno-44-23" name="__codelineno-44-23" href="#__codelineno-44-23"></a>
<a id="__codelineno-44-24" name="__codelineno-44-24" href="#__codelineno-44-24"></a><span class="nv">$sorted_list</span> <span class="p">=</span> <span class="nv">$added_notes</span><span class="p">.</span><span class="n">result</span> <span class="p">|</span> <span class="nb">Sort-Object</span> <span class="n">-Descending</span> <span class="p">{</span><span class="no">[Long]</span><span class="nv">$_</span><span class="p">};</span>
<a id="__codelineno-44-25" name="__codelineno-44-25" href="#__codelineno-44-25"></a>
<a id="__codelineno-44-26" name="__codelineno-44-26" href="#__codelineno-44-26"></a><span class="nv">$prev_note_id</span> <span class="p">=</span> <span class="nv">$sorted_list</span><span class="p">[</span><span class="n">1</span><span class="p">];</span>
<a id="__codelineno-44-27" name="__codelineno-44-27" href="#__codelineno-44-27"></a><span class="nv">$curr_note_id</span> <span class="p">=</span> <span class="nv">$sorted_list</span><span class="p">[</span><span class="n">0</span><span class="p">];</span>
<a id="__codelineno-44-28" name="__codelineno-44-28" href="#__codelineno-44-28"></a>
<a id="__codelineno-44-29" name="__codelineno-44-29" href="#__codelineno-44-29"></a>
<a id="__codelineno-44-30" name="__codelineno-44-30" href="#__codelineno-44-30"></a><span class="nv">$curr_note_data</span> <span class="p">=</span> <span class="n">Run-Json</span> <span class="p">@{</span>
<a id="__codelineno-44-31" name="__codelineno-44-31" href="#__codelineno-44-31"></a>    <span class="n">action</span> <span class="p">=</span> <span class="s1">'notesInfo'</span><span class="p">;</span>
<a id="__codelineno-44-32" name="__codelineno-44-32" href="#__codelineno-44-32"></a>    <span class="n">version</span> <span class="p">=</span> <span class="n">6</span><span class="p">;</span>
<a id="__codelineno-44-33" name="__codelineno-44-33" href="#__codelineno-44-33"></a>    <span class="n">params</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-44-34" name="__codelineno-44-34" href="#__codelineno-44-34"></a>        <span class="n">notes</span> <span class="p">=</span> <span class="p">@(</span><span class="nv">$curr_note_id</span><span class="p">);</span>
<a id="__codelineno-44-35" name="__codelineno-44-35" href="#__codelineno-44-35"></a>    <span class="p">}</span>
<a id="__codelineno-44-36" name="__codelineno-44-36" href="#__codelineno-44-36"></a><span class="p">};</span>
<a id="__codelineno-44-37" name="__codelineno-44-37" href="#__codelineno-44-37"></a>
<a id="__codelineno-44-38" name="__codelineno-44-38" href="#__codelineno-44-38"></a><span class="c"># copies frequency, sentence, sentence reading to previous note</span>
<a id="__codelineno-44-39" name="__codelineno-44-39" href="#__codelineno-44-39"></a><span class="n">Run-Json</span> <span class="p">@{</span>
<a id="__codelineno-44-40" name="__codelineno-44-40" href="#__codelineno-44-40"></a>    <span class="n">action</span> <span class="p">=</span> <span class="s1">'updateNoteFields'</span><span class="p">;</span>
<a id="__codelineno-44-41" name="__codelineno-44-41" href="#__codelineno-44-41"></a>    <span class="n">version</span> <span class="p">=</span> <span class="n">6</span><span class="p">;</span>
<a id="__codelineno-44-42" name="__codelineno-44-42" href="#__codelineno-44-42"></a>    <span class="n">params</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-44-43" name="__codelineno-44-43" href="#__codelineno-44-43"></a>        <span class="n">note</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-44-44" name="__codelineno-44-44" href="#__codelineno-44-44"></a>            <span class="n">id</span> <span class="p">=</span> <span class="nv">$prev_note_id</span><span class="p">;</span>
<a id="__codelineno-44-45" name="__codelineno-44-45" href="#__codelineno-44-45"></a>            <span class="n">fields</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-44-46" name="__codelineno-44-46" href="#__codelineno-44-46"></a>                <span class="n">FrequenciesStylized</span> <span class="p">=</span> <span class="nv">$curr_note_data</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">fields</span><span class="p">.</span><span class="n">FrequenciesStylized</span><span class="p">.</span><span class="n">value</span><span class="p">;</span>
<a id="__codelineno-44-47" name="__codelineno-44-47" href="#__codelineno-44-47"></a>                <span class="n">Sentence</span> <span class="p">=</span> <span class="nv">$curr_note_data</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">fields</span><span class="p">.</span><span class="n">Sentence</span><span class="p">.</span><span class="n">value</span><span class="p">;</span>
<a id="__codelineno-44-48" name="__codelineno-44-48" href="#__codelineno-44-48"></a>                <span class="n">SentenceReading</span> <span class="p">=</span> <span class="nv">$curr_note_data</span><span class="p">.</span><span class="n">result</span><span class="p">.</span><span class="n">fields</span><span class="p">.</span><span class="n">SentenceReading</span><span class="p">.</span><span class="n">value</span><span class="p">;</span>
<a id="__codelineno-44-49" name="__codelineno-44-49" href="#__codelineno-44-49"></a>            <span class="p">}</span>
<a id="__codelineno-44-50" name="__codelineno-44-50" href="#__codelineno-44-50"></a>        <span class="p">}</span>
<a id="__codelineno-44-51" name="__codelineno-44-51" href="#__codelineno-44-51"></a>    <span class="p">}</span>
<a id="__codelineno-44-52" name="__codelineno-44-52" href="#__codelineno-44-52"></a><span class="p">};</span>
<a id="__codelineno-44-53" name="__codelineno-44-53" href="#__codelineno-44-53"></a>
<a id="__codelineno-44-54" name="__codelineno-44-54" href="#__codelineno-44-54"></a><span class="c"># removes current note</span>
<a id="__codelineno-44-55" name="__codelineno-44-55" href="#__codelineno-44-55"></a><span class="n">Run-Json</span> <span class="p">@{</span>
<a id="__codelineno-44-56" name="__codelineno-44-56" href="#__codelineno-44-56"></a>    <span class="n">action</span> <span class="p">=</span> <span class="s1">'deleteNotes'</span><span class="p">;</span>
<a id="__codelineno-44-57" name="__codelineno-44-57" href="#__codelineno-44-57"></a>    <span class="n">version</span> <span class="p">=</span> <span class="n">6</span><span class="p">;</span>
<a id="__codelineno-44-58" name="__codelineno-44-58" href="#__codelineno-44-58"></a>    <span class="n">params</span> <span class="p">=</span> <span class="p">@{</span>
<a id="__codelineno-44-59" name="__codelineno-44-59" href="#__codelineno-44-59"></a>        <span class="n">notes</span> <span class="p">=</span> <span class="p">@(</span><span class="nv">$curr_note_id</span><span class="p">);</span>
<a id="__codelineno-44-60" name="__codelineno-44-60" href="#__codelineno-44-60"></a>    <span class="p">}</span>
<a id="__codelineno-44-61" name="__codelineno-44-61" href="#__codelineno-44-61"></a><span class="p">};</span>
</code></pre></div>
</details>
</details></div>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">October 8, 2023</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "toc.follow", "header.autohide", "navigation.tabs", "navigation.sections", "content.code.annotate", "content.code.copy", "content.action.view"], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.b4d07000.min.js"></script>
      
    
  </body>
</html>